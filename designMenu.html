<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ½ï¸ Kids Restaurant Creator! ğŸ¨</title>
    <link href="[https://fonts.googleapis.com/css2?family=Baloo+2:wght@400;700&display=swap](https://fonts.googleapis.com/css2?family=Baloo+2:wght@400;700&display=swap)" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Baloo 2', 'Comic Sans MS', cursive, sans-serif;
            background: #fffbe6; /* warm pale yellow */
            animation: none; /* remove rainbow animation for calmer look */
            min-height: 100vh;
            overflow-x: hidden;
            font-size: 1.1rem; /* ~18px */
        }
        
        #background-emojis {
            display: none; /* remove floating emojis for focus */
        }

        @keyframes float {
            0% { transform: translateY(100vh) rotate(0deg); }
            100% { transform: translateY(-10vh) rotate(360deg); }
        }

        @keyframes superRainbow {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            position: relative;
        }

        .header {
            text-align: center;
            margin-bottom: 10px; /* was 20px */
            animation: bounce 2s infinite;
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-10px); }
            60% { transform: translateY(-5px); }
        }

        .title {
            font-size: 2.8rem; /* was 3.5rem */
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4, #45b7d1, #ffd93d);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: titleRainbow 3s ease infinite;
            margin-bottom: 5px; /* was 10px */
            font-weight: bold;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }

        @keyframes titleRainbow {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .subtitle {
            font-size: 1.2rem; /* was 1.5rem */
            color: #555;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
        }

        .navigation {
            display: flex;
            justify-content: center;
            gap: 6px; /* was 10px */
            margin-bottom: 10px; /* was 20px */
            flex-wrap: wrap;
        }

        .nav-btn {
            background: linear-gradient(45deg, #4ecdc4, #44a08d);
            color: white;
            border: none;
            padding: 8px 16px; /* Reduced padding */
            border-radius: 20px;
            font-size: 1.1rem; /* Updated font size */
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            border: 3px solid transparent;
        }

        .nav-btn:hover {
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 8px 25px rgba(0,0,0,0.3);
        }

        .nav-btn.active {
            background: linear-gradient(45deg, #ffd700, #ff8c00);
            border-color: #ff6b6b;
            animation: pulse 1.5s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .page {
            display: none;
            background: rgba(255,255,255,0.95);
            border-radius: 25px;
            padding: 20px; /* was 30px */
            box-shadow: 0 15px 40px rgba(0,0,0,0.2);
            border: 5px solid #ffd700;
            min-height: auto; /* remove fixed 600px so it can shrink */
        }

        .page.active {
            display: block;
            animation: slideIn 0.8s ease;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateY(50px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .page-title {
            font-size: 2.2rem;
            color: #333;
            text-align: center;
            margin-bottom: 15px; /* was 30px */
        }

        .drop-zone {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: 4px dashed #ffd700;
            border-radius: 20px;
            padding: 20px; /* was 30px */
            margin-bottom: 0; /* remove extra gap */
            min-height: 150px; /* was 200px */
            text-align: center;
            color: white;
            font-size: 1.2rem;
            font-weight: bold;
            transition: all 0.3s ease;
            position: relative;
            flex: 1;
        }

        .drop-zone.drag-over {
            background: linear-gradient(135deg, #4ecdc4 0%, #44a08d 100%);
            border-color: #2ecc71;
            transform: scale(1.02);
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        .drop-zone h3 {
            margin-bottom: 15px;
            font-size: 1.5rem;
        }

        .dropped-items {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
            margin-top: 15px;
        }

        .dropped-item {
            background: #ffffff;
            color: #000;
            border-radius: 15px;
            padding: 10px 15px;
            font-size: 1.5rem;
            animation: itemPop 0.5s ease;
            border: 2px solid rgba(0,0,0,0.1);
            cursor: pointer;
            text-transform: capitalize; /* Capitalize first letter for display */
        }

        @keyframes itemPop {
            0% { transform: scale(0); }
            80% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        .emoji-palette {
            background: rgba(255,255,255,0.9);
            border-radius: 20px;
            padding: 15px; /* was 20px */
            margin-top: 10px; /* was 20px */
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .emoji-categories-container {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .emoji-category {
            margin-bottom: 10px; /* was 20px */
            flex: 1;
            min-width: 200px;
        }

        .emoji-category h4 {
            color: #333;
            margin-bottom: 10px;
            font-size: 1.3rem;
        }

        .emoji-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(60px, 1fr));
            gap: 10px;
        }

        .emoji-item {
            background: linear-gradient(145deg, #ffffff, #f0f0f0);
            border: 1px solid #ddd;
            border-radius: 15px;
            padding: 15px;
            font-size: 2rem;
            cursor: grab;
            transition: all 0.3s ease;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }

        .emoji-item:hover {
            transform: scale(1.1) rotate(5deg);
            box-shadow: 0 8px 25px rgba(0,0,0,0.3);
        }

        .emoji-item:active {
            cursor: grabbing;
            transform: scale(1.2);
        }

        .price-controls {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin: 15px 0;
            flex-wrap: wrap;
        }
        
        .price-controls span:first-of-type {
             text-transform: capitalize;
        }

        .price-controls span {
             min-width: 80px;
             text-align: center;
             font-size: 1.1rem;
        }

        .price-dial {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: linear-gradient(45deg, #ffd700, #ff8c00);
            border: 4px solid #fff;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 1.2rem;
            font-weight: bold;
            color: white;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .price-dial:hover {
            transform: scale(1.1) rotate(10deg);
            box-shadow: 0 8px 25px rgba(0,0,0,0.3);
        }
        
        .staff-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
        }

        .staff-container > .summary-card {
            margin: 0;
        }

        .staff-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 20px;
            padding: 20px;
            margin: 0;
            color: #fff;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
        }

        .staff-emoji {
            font-size: 3rem;
            text-align: center;
            margin-bottom: 15px;
        }

        .staff-input {
            width: 100%;
            padding: 10px;
            border: none;
            border-radius: 10px;
            font-size: 1.1rem;
            text-align: center;
            background: rgba(255,255,255,0.9);
            margin-top: 10px;
            color: #333;
        }

        .time-selector {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .time-card {
            background: linear-gradient(135deg, #4ecdc4 0%, #44a08d 100%);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 3px solid transparent;
        }

        .time-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        .time-card.selected {
            border-color: #ffd700;
            background: linear-gradient(135deg, #ffd700 0%, #ff8c00 100%);
            animation: pulse 1.5s infinite;
        }

        .country-flags {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        
        .staff-country-selector {
            display: flex;
            justify-content: center;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: 15px;
        }
        
        .staff-country-selector .flag-item {
            padding: 10px;
            background: rgba(255,255,255,0.8);
        }
        
        .staff-country-selector .flag-item .flag-emoji {
             font-size: 1.5rem;
             margin-bottom: 5px;
        }

        .flag-item {
            background: white;
            border-radius: 15px;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            border: 3px solid transparent;
        }
        
        .flag-emoji {
            font-family: "Segoe UI Emoji", "Apple Color Emoji", "Noto Color Emoji", sans-serif;
        }

        .flag-item:hover {
            transform: scale(1.05);
            box-shadow: 0 8px 25px rgba(0,0,0,0.3);
        }

        .flag-item.selected {
            border-color: #ffd700;
            background: linear-gradient(45deg, #ffd700, #ff8c00);
        }

        .flag-emoji {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .currency-display {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            padding: 15px;
            border-radius: 15px;
            text-align: center;
            font-size: 1.3rem;
            font-weight: bold;
            margin: 15px 0;
        }

        .summary-card {
            background: linear-gradient(135deg, #4ecdc4 0%, #44a08d 100%);
            border-radius: 20px;
            padding: 25px;
            margin: 15px 0;
            color: #fff;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
        }

        .summary-title {
            font-size: 1.5rem;
            margin-bottom: 15px;
            text-align: center;
        }

        .menu-preview {
            background: #ffffff;
            color: #000;
            border-radius: 15px;
            padding: 15px;
            margin: 10px 0;
            font-size: 1.1rem;
        }

        .menu-preview div {
            text-transform: capitalize;
        }

        .celebration {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1000;
        }

        .confetti {
            position: absolute;
            width: 10px;
            height: 10px;
            background: #ff6b6b;
            animation: confettiFall 3s linear infinite;
        }
        
        .notification {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background-color: #ff6b6b;
            color: white;
            padding: 10px 20px;
            border-radius: 20px;
            z-index: 2000;
            display: none;
            opacity: 0;
            transition: opacity 0.5s ease;
        }

        @keyframes confettiFall {
            0% {
                transform: translateY(-100vh) rotate(0deg);
                opacity: 1;
            }
            100% {
                transform: translateY(100vh) rotate(360deg);
                opacity: 0;
            }
        }
        
        /* ====== Side-by-side drop zones ====== */
        .drop-zone-container {
            display: flex;
            gap: 20px;
            align-items: flex-start;
            margin-bottom: 15px;
        }


        @media (max-width: 768px) {
            .title {
                font-size: 2.5rem;
            }
            .navigation {
                gap: 5px; /* Further reduced gap */
            }
            .nav-btn {
                padding: 8px 12px; /* Further reduced padding */
                font-size: 0.8rem; /* Further reduced font size */
            }
            .emoji-grid {
                grid-template-columns: repeat(auto-fill, minmax(50px, 1fr));
            }
            .emoji-item {
                font-size: 1.5rem;
                padding: 10px;
            }
            .price-dial {
                width: 45px;
                height: 45px;
            }
            .price-controls {
                gap: 5px;
            }
            .drop-zone-container {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div id="background-emojis"></div>
    <div id="notification" class="notification"></div>
    <div class="container">
        <div class="header">
            <h1 class="title" id="mainTitle">ğŸ½ï¸ Kids Restaurant Creator! ğŸ¨</h1>
            <p class="subtitle" id="mainSubtitle">Create your amazing restaurant!</p>
        </div>

        <div class="navigation">
            <button class="nav-btn active" onclick="showPage(event, 'setup')">ğŸª Setup</button>
            <button class="nav-btn" onclick="showPage(event, 'menu')">ğŸ  Menu</button>
            <button class="nav-btn" onclick="showPage(event, 'breakfast')">ğŸŒ… Breakfast</button>
            <button class="nav-btn" onclick="showPage(event, 'lunch')">â˜€ï¸ Lunch</button>
            <button class="nav-btn" onclick="showPage(event, 'dinner')">ğŸŒ™ Dinner</button>
            <button class="nav-btn" onclick="showPage(event, 'prices')">ğŸ’° Prices</button>
            <button class="nav-btn" onclick="showPage(event, 'times')">â° Hours</button>
            <button class="nav-btn" onclick="showPage(event, 'staff')">ğŸ‘¥ Staff</button>
            <button class="nav-btn" onclick="showPage(event, 'summary')">ğŸ“‹ Summary</button>
        </div>

        <!-- Restaurant Setup Page -->
        <div id="setup" class="page active">
            <h2 class="page-title">ğŸª Setup Your Restaurant</h2>

            <div class="summary-card">
                <div class="summary-title">ğŸ¯ Tell Us About You & Your Restaurant</div>
                <div class="staff-container">
                    <div class="staff-card">
                        <div class="staff-emoji">ğŸ‘¤</div>
                        <h3 style="text-align: center;">Your Name</h3>
                        <input type="text" class="staff-input" placeholder="Enter your name" id="ownerName" oninput="updateNames()">
                    </div>
                    
                    <div class="staff-card">
                        <div class="staff-emoji">ğŸª</div>
                        <h3 style="text-align: center;">Restaurant Name</h3>
                        <input type="text" class="staff-input" placeholder="Enter restaurant name" id="restaurantName" oninput="updateNames()">
                    </div>
                </div>
            </div>
        </div>

        <!-- Menu Overview Page -->
        <div id="menu" class="page">
            <h2 class="page-title">ğŸ  Welcome to Your Restaurant!</h2>
            <div class="staff-container">
                <div class="summary-card">
                    <div class="summary-title">ğŸ¯ Your Mission</div>
                    <p style="font-size: 1.2rem; text-align: center; line-height: 1.6;" id="missionText">
                        Create the most amazing restaurant ever! <span aria-hidden="true">ğŸŒŸ</span><br>
                        Drag and drop food emojis, set prices, pick opening hours, and hire your dream team! <span aria-hidden="true">ğŸš€</span>
                    </p>
                </div>
                
                <div class="summary-card">
                    <div class="summary-title">ğŸ“Š Restaurant Progress</div>
                    <div id="progressDisplay" style="font-size: 1.1rem; line-height: 1.8;">
                        <div>ğŸ³ Breakfast Menu: <span id="breakfastCount">0</span> items</div>
                        <div>ğŸ½ï¸ Lunch Menu: <span id="lunchCount">0</span> items</div>
                        <div>ğŸŒ™ Dinner Menu: <span id="dinnerCount">0</span> items</div>
                        <div>ğŸ‘¥ Staff Hired: <span id="staffCount">0</span>/5</div>
                        <div>â° Hours Set: <span id="hoursCount">0</span>/4</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Breakfast Page -->
        <div id="breakfast" class="page">
            <h2 class="page-title">ğŸŒ… Create Breakfast Menu</h2>
            
            <div class="drop-zone-container">
                <div class="drop-zone" id="breakfastFood" ondrop="drop(event)" ondragover="allowDrop(event)" ondragleave="dragLeave(event)">
                    <h3>ğŸ³ Breakfast Foods</h3>
                    <p>Drag breakfast foods here!</p>
                    <div class="dropped-items" id="breakfastFoodItems"></div>
                </div>

                <div class="drop-zone" id="breakfastDrinks" ondrop="drop(event)" ondragover="allowDrop(event)" ondragleave="dragLeave(event)">
                    <h3>â˜• Breakfast Drinks</h3>
                    <p>Drag drinks here!</p>
                    <div class="dropped-items" id="breakfastDrinkItems"></div>
                </div>
            </div>

            <div class="emoji-palette">
                <div class="emoji-categories-container">
                    <div class="emoji-category">
                        <h4>ğŸ³ Foods</h4>
                        <div class="emoji-grid">
                            <button class="emoji-item" draggable="true" ondragstart="drag(event)" data-emoji="ğŸ¥" data-name="pancakes" onclick="handleTap(event)">ğŸ¥</button>
                            <button class="emoji-item" draggable="true" ondragstart="drag(event)" data-emoji="ğŸ§‡" data-name="waffles" onclick="handleTap(event)">ğŸ§‡</button>
                            <button class="emoji-item" draggable="true" ondragstart="drag(event)" data-emoji="ğŸ³" data-name="eggs" onclick="handleTap(event)">ğŸ³</button>
                            <button class="emoji-item" draggable="true" ondragstart="drag(event)" data-emoji="ğŸ¥“" data-name="bacon" onclick="handleTap(event)">ğŸ¥“</button>
                            <button class="emoji-item" draggable="true" ondragstart="drag(event)" data-emoji="ğŸ¥" data-name="croissant" onclick="handleTap(event)">ğŸ¥</button>
                            <button class="emoji-item" draggable="true" ondragstart="drag(event)" data-emoji="ğŸ¥–" data-name="baguette" onclick="handleTap(event)">ğŸ¥–</button>
                            <button class="emoji-item" draggable="true" ondragstart="drag(event)" data-emoji="ğŸ¥£" data-name="cereal" onclick="handleTap(event)">ğŸ¥£</button>
                            <button class="emoji-item" draggable="true" ondragstart="drag(event)" data-emoji="ğŸ" data-name="toast" onclick="handleTap(event)">ğŸ</button>
                            <button class="emoji-item" draggable="true" ondragstart="drag(event)" data-emoji="ğŸ¥‘" data-name="avocado" onclick="handleTap(event)">ğŸ¥‘</button>
                        </div>
                    </div>
                     <div class="emoji-category">
                        <h4>ğŸ“ Fruits</h4>
                        <div class="emoji-grid">
                            <button class="emoji-item" draggable="true" ondragstart="drag(event)" data-emoji="ğŸ“" data-name="strawberry" onclick="handleTap(event)">ğŸ“</button>
                            <button class="emoji-item" draggable="true" ondragstart="drag(event)" data-emoji="ğŸŒ" data-name="banana" onclick="handleTap(event)">ğŸŒ</button>
                            <button class="emoji-item" draggable="true" ondragstart="drag(event)" data-emoji="ğŸ‡" data-name="grapes" onclick="handleTap(event)">ğŸ‡</button>
                            <button class="emoji-item" draggable="true" ondragstart="drag(event)" data-emoji="ğŸ" data-name="apple" onclick="handleTap(event)">ğŸ</button>
                        </div>
                    </div>
                    <div class="emoji-category">
                        <h4>â˜• Drinks</h4>
                        <div class="emoji-grid">
                            <button class="emoji-item" draggable="true" ondragstart="drag(event)" data-emoji="â˜•" data-name="coffee" onclick="handleTap(event)">â˜•</button>
                            <button class="emoji-item" draggable="true" ondragstart="drag(event)" data-emoji="ğŸ¥›" data-name="milk" onclick="handleTap(event)">ğŸ¥›</button>
                            <button class="emoji-item" draggable="true" ondragstart="drag(event)" data-emoji="ğŸ§ƒ" data-name="juice" onclick="handleTap(event)">ğŸ§ƒ</button>
                            <button class="emoji-item" draggable="true" ondragstart="drag(event)" data-emoji="ğŸµ" data-name="tea" onclick="handleTap(event)">ğŸµ</button>
                            <button class="emoji-item" draggable="true" ondragstart="drag(event)" data-emoji="ğŸ§‹" data-name="bubble tea" onclick="handleTap(event)">ğŸ§‹</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Lunch Page -->
        <div id="lunch" class="page">
            <h2 class="page-title">â˜€ï¸ Create Lunch Menu</h2>
            
            <div class="drop-zone-container">
                <div class="drop-zone" id="lunchFood" ondrop="drop(event)" ondragover="allowDrop(event)" ondragleave="dragLeave(event)">
                    <h3>ğŸ½ï¸ Lunch Foods</h3>
                    <p>Drag lunch foods here!</p>
                    <div class="dropped-items" id="lunchFoodItems"></div>
                </div>

                <div class="drop-zone" id="lunchDrinks" ondrop="drop(event)" ondragover="allowDrop(event)" ondragleave="dragLeave(event)">
                    <h3>ğŸ¥¤ Lunch Drinks</h3>
                    <p>Drag drinks here!</p>
                    <div class="dropped-items" id="lunchDrinkItems"></div>
                </div>
            </div>

            <div class="emoji-palette">
                <div class="emoji-categories-container">
                    <div class="emoji-category">
                        <h4>ğŸ½ï¸ Foods</h4>
                        <div class="emoji-grid">
                            <button class="emoji-item" draggable="true" ondragstart="drag(event)" data-emoji="ğŸ”" data-name="burger" onclick="handleTap(event)">ğŸ”</button>
                            <button class="emoji-item" draggable="true" ondragstart="drag(event)" data-emoji="ğŸ•" data-name="pizza" onclick="handleTap(event)">ğŸ•</button>
                            <button class="emoji-item" draggable="true" ondragstart="drag(event)" data-emoji="ğŸ¥ª" data-name="sandwich" onclick="handleTap(event)">ğŸ¥ª</button>
                            <button class="emoji-item" draggable="true" ondragstart="drag(event)" data-emoji="ğŸ¥—" data-name="salad" onclick="handleTap(event)">ğŸ¥—</button>
                            <button class="emoji-item" draggable="true" ondragstart="drag(event)" data-emoji="ğŸŒ®" data-name="taco" onclick="handleTap(event)">ğŸŒ®</button>
                            <button class="emoji-item" draggable="true" ondragstart="drag(event)" data-emoji="ğŸŸ" data-name="fries" onclick="handleTap(event)">ğŸŸ</button>
                            <button class="emoji-item" draggable="true" ondragstart="drag(event)" data-emoji="ğŸ¥¨" data-name="pretzel" onclick="handleTap(event)">ğŸ¥¨</button>
                            <button class="emoji-item" draggable="true" ondragstart="drag(event)" data-emoji="ğŸœ" data-name="noodles" onclick="handleTap(event)">ğŸœ</button>
                            <button class="emoji-item" draggable="true" ondragstart="drag(event)" data-emoji="ğŸ™" data-name="rice ball" onclick="handleTap(event)">ğŸ™</button>
                        </div>
                    </div>
                     <div class="emoji-category">
                        <h4>ğŸ‰ Fruits</h4>
                        <div class="emoji-grid">
                            <button class="emoji-item" draggable="true" ondragstart="drag(event)" data-emoji="ğŸ‰" data-name="watermelon" onclick="handleTap(event)">ğŸ‰</button>
                            <button class="emoji-item" draggable="true" ondragstart="drag(event)" data-emoji="ğŸŠ" data-name="orange" onclick="handleTap(event)">ğŸŠ</button>
                            <button class="emoji-item" draggable="true" ondragstart="drag(event)" data-emoji="ğŸ" data-name="pineapple" onclick="handleTap(event)">ğŸ</button>
                            <button class="emoji-item" draggable="true" ondragstart="drag(event)" data-emoji="ğŸ¥" data-name="kiwi" onclick="handleTap(event)">ğŸ¥</button>
                        </div>
                    </div>
                    <div class="emoji-category">
                        <h4>ğŸ¥¤ Drinks</h4>
                        <div class="emoji-grid">
                            <button class="emoji-item" draggable="true" ondragstart="drag(event)" data-emoji="ğŸ¥¤" data-name="soda" onclick="handleTap(event)">ğŸ¥¤</button>
                            <button class="emoji-item" draggable="true" ondragstart="drag(event)" data-emoji="ğŸ’§" data-name="water" onclick="handleTap(event)">ğŸ’§</button>
                            <button class="emoji-item" draggable="true" ondragstart="drag(event)" data-emoji="ğŸ§‹" data-name="bubble tea" onclick="handleTap(event)">ğŸ§‹</button>
                            <button class="emoji-item" draggable="true" ondragstart="drag(event)" data-emoji="ğŸ‹" data-name="lemonade" onclick="handleTap(event)">ğŸ‹</button>
                            <button class="emoji-item" draggable="true" ondragstart="drag(event)" data-emoji="ğŸ¥¥" data-name="coconut water" onclick="handleTap(event)">ğŸ¥¥</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Dinner Page -->
        <div id="dinner" class="page">
            <h2 class="page-title">ğŸŒ™ Create Dinner Menu</h2>
            
            <div class="drop-zone-container">
                <div class="drop-zone" id="dinnerFood" ondrop="drop(event)" ondragover="allowDrop(event)" ondragleave="dragLeave(event)">
                    <h3>ğŸ½ï¸ Dinner Foods</h3>
                    <p>Drag dinner foods here!</p>
                    <div class="dropped-items" id="dinnerFoodItems"></div>
                </div>

                <div class="drop-zone" id="dinnerDrinks" ondrop="drop(event)" ondragover="allowDrop(event)" ondragleave="dragLeave(event)">
                    <h3>ğŸ· Dinner Drinks</h3>
                    <p>Drag drinks here!</p>
                    <div class="dropped-items" id="dinnerDrinkItems"></div>
                </div>
            </div>

            <div class="emoji-palette">
                <div class="emoji-categories-container">
                    <div class="emoji-category">
                        <h4>ğŸ½ï¸ Foods</h4>
                        <div class="emoji-grid">
                            <button class="emoji-item" draggable="true" ondragstart="drag(event)" data-emoji="ğŸ¥©" data-name="steak" onclick="handleTap(event)">ğŸ¥©</button>
                            <button class="emoji-item" draggable="true" ondragstart="drag(event)" data-emoji="ğŸ—" data-name="chicken" onclick="handleTap(event)">ğŸ—</button>
                            <button class="emoji-item" draggable="true" ondragstart="drag(event)" data-emoji="ğŸ" data-name="pasta" onclick="handleTap(event)">ğŸ</button>
                            <button class="emoji-item" draggable="true" ondragstart="drag(event)" data-emoji="ğŸ›" data-name="curry" onclick="handleTap(event)">ğŸ›</button>
                            <button class="emoji-item" draggable="true" ondragstart="drag(event)" data-emoji="ğŸ£" data-name="sushi" onclick="handleTap(event)">ğŸ£</button>
                            <button class="emoji-item" draggable="true" ondragstart="drag(event)" data-emoji="ğŸ¥˜" data-name="paella" onclick="handleTap(event)">ğŸ¥˜</button>
                            <button class="emoji-item" draggable="true" ondragstart="drag(event)" data-emoji="ğŸ¥Ÿ" data-name="dumpling" onclick="handleTap(event)">ğŸ¥Ÿ</button>
                            <button class="emoji-item" draggable="true" ondragstart="drag(event)" data-emoji="ğŸ¦" data-name="lobster" onclick="handleTap(event)">ğŸ¦</button>
                            <button class="emoji-item" draggable="true" ondragstart="drag(event)" data-emoji="ğŸš" data-name="rice" onclick="handleTap(event)">ğŸš</button>
                        </div>
                    </div>
                     <div class="emoji-category">
                        <h4>ğŸ° Desserts</h4>
                        <div class="emoji-grid">
                            <button class="emoji-item" draggable="true" ondragstart="drag(event)" data-emoji="ğŸ°" data-name="cake" onclick="handleTap(event)">ğŸ°</button>
                            <button class="emoji-item" draggable="true" ondragstart="drag(event)" data-emoji="ğŸ¨" data-name="ice cream" onclick="handleTap(event)">ğŸ¨</button>
                            <button class="emoji-item" draggable="true" ondragstart="drag(event)" data-emoji="ğŸ’" data-name="cherries" onclick="handleTap(event)">ğŸ’</button>
                            <button class="emoji-item" draggable="true" ondragstart="drag(event)" data-emoji="ğŸ©" data-name="donut" onclick="handleTap(event)">ğŸ©</button>
                            <button class="emoji-item" draggable="true" ondragstart="drag(event)" data-emoji="ğŸª" data-name="cookie" onclick="handleTap(event)">ğŸª</button>
                        </div>
                    </div>
                    <div class="emoji-category">
                        <h4>ğŸ· Drinks</h4>
                        <div class="emoji-grid">
                            <button class="emoji-item" draggable="true" ondragstart="drag(event)" data-emoji="ğŸ·" data-name="wine" onclick="handleTap(event)">ğŸ·</button>
                            <button class="emoji-item" draggable="true" ondragstart="drag(event)" data-emoji="ğŸ’§" data-name="water" onclick="handleTap(event)">ğŸ’§</button>
                            <button class="emoji-item" draggable="true" ondragstart="drag(event)" data-emoji="ğŸ¹" data-name="juice" onclick="handleTap(event)">ğŸ¹</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Prices Page -->
        <div id="prices" class="page">
            <h2 class="page-title">ğŸ’° Set Your Prices</h2>
            
            <div class="currency-display" id="currencyDisplay">
                Currency: USD ($)
            </div>

            <div id="pricesList">
                <!-- Price controls will be generated here -->
            </div>
        </div>

        <!-- Times Page -->
        <div id="times" class="page">
            <h2 class="page-title">â° Set Opening Hours</h2>
            
            <div class="time-selector">
                <div class="time-card" onclick="toggleTime(this, 'breakfast')">
                    <h3>ğŸŒ… Breakfast</h3>
                    <div class="price-controls">
                        <div class="price-dial" onclick="adjustTime('breakfast', 'start', -5)">-</div>
                        <span id="breakfast-start">6:00 AM</span>
                        <div class="price-dial" onclick="adjustTime('breakfast', 'start', 5)">+</div>
                        <span>to</span>
                        <div class="price-dial" onclick="adjustTime('breakfast', 'end', -5)">-</div>
                        <span id="breakfast-end">11:00 AM</span>
                        <div class="price-dial" onclick="adjustTime('breakfast', 'end', 5)">+</div>
                    </div>
                </div>
                <div class="time-card" onclick="toggleTime(this, 'brunch')">
                    <h3>ğŸ¥ Brunch</h3>
                    <div class="price-controls">
                        <div class="price-dial" onclick="adjustTime('brunch', 'start', -5)">-</div>
                        <span id="brunch-start">10:00 AM</span>
                        <div class="price-dial" onclick="adjustTime('brunch', 'start', 5)">+</div>
                        <span>to</span>
                        <div class="price-dial" onclick="adjustTime('brunch', 'end', -5)">-</div>
                        <span id="brunch-end">2:00 PM</span>
                        <div class="price-dial" onclick="adjustTime('brunch', 'end', 5)">+</div>
                    </div>
                </div>
                <div class="time-card" onclick="toggleTime(this, 'lunch')">
                    <h3>â˜€ï¸ Lunch</h3>
                    <div class="price-controls">
                        <div class="price-dial" onclick="adjustTime('lunch', 'start', -5)">-</div>
                        <span id="lunch-start">11:00 AM</span>
                        <div class="price-dial" onclick="adjustTime('lunch', 'start', 5)">+</div>
                        <span>to</span>
                        <div class="price-dial" onclick="adjustTime('lunch', 'end', -5)">-</div>
                        <span id="lunch-end">4:00 PM</span>
                        <div class="price-dial" onclick="adjustTime('lunch', 'end', 5)">+</div>
                    </div>
                </div>
                <div class="time-card" onclick="toggleTime(this, 'dinner')">
                    <h3>ğŸŒ™ Dinner</h3>
                    <div class="price-controls">
                        <div class="price-dial" onclick="adjustTime('dinner', 'start', -5)">-</div>
                        <span id="dinner-start">5:00 PM</span>
                        <div class="price-dial" onclick="adjustTime('dinner', 'start', 5)">+</div>
                        <span>to</span>
                        <div class="price-dial" onclick="adjustTime('dinner', 'end', -5)">-</div>
                        <span id="dinner-end">10:00 PM</span>
                        <div class="price-dial" onclick="adjustTime('dinner', 'end', 5)">+</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Staff Page -->
        <div id="staff" class="page">
            <h2 class="page-title">ğŸ‘¥ Hire Your Dream Team</h2>
            
            <div class="staff-container">
                <div class="staff-card">
                    <div class="staff-emoji">ğŸ‘¨â€ğŸ³</div>
                    <h3 style="text-align: center;">Head Chef</h3>
                    <input type="text" class="staff-input" placeholder="Enter chef's name" id="chefName" data-role="chef">
                    <div class="staff-country-selector">
                         <div class="flag-item" onclick="selectStaffCountry(this, 'chef', 'de-DE')"><div class="flag-emoji">ğŸ‡©ğŸ‡ª</div></div>
                         <div class="flag-item" onclick="selectStaffCountry(this, 'chef', 'es-ES')"><div class="flag-emoji">ğŸ‡ªğŸ‡¸</div></div>
                         <div class="flag-item" onclick="selectStaffCountry(this, 'chef', 'fr-FR')"><div class="flag-emoji">ğŸ‡«ğŸ‡·</div></div>
                         <div class="flag-item" onclick="selectStaffCountry(this, 'chef', 'zh-CN')"><div class="flag-emoji">ğŸ‡¨ğŸ‡³</div></div>
                         <div class="flag-item" onclick="selectStaffCountry(this, 'chef', 'en-AU')"><div class="flag-emoji">ğŸ‡¦ğŸ‡º</div></div>
                    </div>
                </div>

                <div class="staff-card">
                    <div class="staff-emoji">ğŸ‘©â€ğŸ³</div>
                    <h3 style="text-align: center;">Cook</h3>
                    <input type="text" class="staff-input" placeholder="Enter cook's name" id="cookName" data-role="cook">
                     <div class="staff-country-selector">
                         <div class="flag-item" onclick="selectStaffCountry(this, 'cook', 'de-DE')"><div class="flag-emoji">ğŸ‡©ğŸ‡ª</div></div>
                         <div class="flag-item" onclick="selectStaffCountry(this, 'cook', 'es-ES')"><div class="flag-emoji">ğŸ‡ªğŸ‡¸</div></div>
                         <div class="flag-item" onclick="selectStaffCountry(this, 'cook', 'fr-FR')"><div class="flag-emoji">ğŸ‡«ğŸ‡·</div></div>
                         <div class="flag-item" onclick="selectStaffCountry(this, 'cook', 'zh-CN')"><div class="flag-emoji">ğŸ‡¨ğŸ‡³</div></div>
                         <div class="flag-item" onclick="selectStaffCountry(this, 'cook', 'en-AU')"><div class="flag-emoji">ğŸ‡¦ğŸ‡º</div></div>
                    </div>
                </div>

                <div class="staff-card">
                    <div class="staff-emoji">ğŸ‘¨â€ğŸ’¼</div>
                    <h3 style="text-align: center;">Manager</h3>
                    <input type="text" class="staff-input" placeholder="Enter manager's name" id="managerName" data-role="manager">
                     <div class="staff-country-selector">
                         <div class="flag-item" onclick="selectStaffCountry(this, 'manager', 'de-DE')"><div class="flag-emoji">ğŸ‡©ğŸ‡ª</div></div>
                         <div class="flag-item" onclick="selectStaffCountry(this, 'manager', 'es-ES')"><div class="flag-emoji">ğŸ‡ªğŸ‡¸</div></div>
                         <div class="flag-item" onclick="selectStaffCountry(this, 'manager', 'fr-FR')"><div class="flag-emoji">ğŸ‡«ğŸ‡·</div></div>
                         <div class="flag-item" onclick="selectStaffCountry(this, 'manager', 'zh-CN')"><div class="flag-emoji">ğŸ‡¨ğŸ‡³</div></div>
                         <div class="flag-item" onclick="selectStaffCountry(this, 'manager', 'en-AU')"><div class="flag-emoji">ğŸ‡¦ğŸ‡º</div></div>
                    </div>
                </div>
                 <div class="staff-card">
                    <div class="staff-emoji">ğŸ¤µ</div>
                    <h3 style="text-align: center;">Waiter</h3>
                    <input type="text" class="staff-input" placeholder="Enter waiter's name" id="waiterName" data-role="waiter">
                     <div class="staff-country-selector">
                         <div class="flag-item" onclick="selectStaffCountry(this, 'waiter', 'de-DE')"><div class="flag-emoji">ğŸ‡©ğŸ‡ª</div></div>
                         <div class="flag-item" onclick="selectStaffCountry(this, 'waiter', 'es-ES')"><div class="flag-emoji">ğŸ‡ªğŸ‡¸</div></div>
                         <div class="flag-item" onclick="selectStaffCountry(this, 'waiter', 'fr-FR')"><div class="flag-emoji">ğŸ‡«ğŸ‡·</div></div>
                         <div class="flag-item" onclick="selectStaffCountry(this, 'waiter', 'zh-CN')"><div class="flag-emoji">ğŸ‡¨ğŸ‡³</div></div>
                         <div class="flag-item" onclick="selectStaffCountry(this, 'waiter', 'en-AU')"><div class="flag-emoji">ğŸ‡¦ğŸ‡º</div></div>
                    </div>
                </div>
                 <div class="staff-card">
                    <div class="staff-emoji">ğŸ¤µâ€â™€ï¸</div>
                    <h3 style="text-align: center;">Waitress</h3>
                    <input type="text" class="staff-input" placeholder="Enter waitress's name" id="waitressName" data-role="waitress">
                     <div class="staff-country-selector">
                         <div class="flag-item" onclick="selectStaffCountry(this, 'waitress', 'de-DE')"><div class="flag-emoji">ğŸ‡©ğŸ‡ª</div></div>
                         <div class="flag-item" onclick="selectStaffCountry(this, 'waitress', 'es-ES')"><div class="flag-emoji">ğŸ‡ªğŸ‡¸</div></div>
                         <div class="flag-item" onclick="selectStaffCountry(this, 'waitress', 'fr-FR')"><div class="flag-emoji">ğŸ‡«ğŸ‡·</div></div>
                         <div class="flag-item" onclick="selectStaffCountry(this, 'waitress', 'zh-CN')"><div class="flag-emoji">ğŸ‡¨ğŸ‡³</div></div>
                         <div class="flag-item" onclick="selectStaffCountry(this, 'waitress', 'en-AU')"><div class="flag-emoji">ğŸ‡¦ğŸ‡º</div></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Summary Page -->
        <div id="summary" class="page">
            <h2 class="page-title">ğŸ“‹ Your Amazing Restaurant!</h2>
            <div id="restaurantSummary"></div>
        </div>
    </div>

    <!-- Celebration Elements -->
    <div class="celebration" id="celebration"></div>

    <script>
        // =================================================================================
        // --- 1. GLOBAL STATE & DATA ---
        // =================================================================================
        
        let restaurant = {
            breakfast: { foods: [], drinks: [] },
            lunch: { foods: [], drinks: [] },
            dinner: { foods: [], drinks: [] },
            prices: {},
            currency: { symbol: '$', code: 'USD', name: 'dollars' },
            staff: {
                chef: { name: '', lang: '' },
                cook: { name: '', lang: '' },
                manager: { name: '', lang: '' },
                waiter: { name: '', lang: '' },
                waitress: { name: '', lang: '' },
            },
            owner: '',
            restaurantName: '',
            openingHours: [],
            times: {
                breakfast: { start: 360, end: 660 }, 
                brunch: { start: 600, end: 840 },  
                lunch: { start: 660, end: 960 },   
                dinner: { start: 1020, end: 1320 } 
            }
        };

        let currentPage = 'setup';
        let chosenStaffLangs = new Set();
        
        const staffScripts = {
            'de-DE': { english: "Hello from Germany!", native: "Ich liebe es, leckere Brezeln und Bratwurst zu machen." },
            'es-ES': { english: "Hello from Spain!", native: "Â¡Tengo muchas ganas de cocinarte una paella!" },
            'fr-FR': { english: "Bonjour from France!", native: "J'adore cuisiner des plats franÃ§ais classiques pour vous!" },
            'zh-CN': { english: "NÇ hÇo from China!", native: "æˆ‘ä»¬åƒç‚¹é¥ºå­å’ŒåŒ—äº¬çƒ¤é¸­å§ã€‚" },
            'en-AU': { english: "G'day from Australia!", native: "How about some fish and chips, mate?" }
        };

        const foodDescriptions = {
            "baguette": { text: "Baguette fraÃ®che et croustillante", lang: "fr-FR" },
            "croissant": { text: "Un croissant au beurre, dÃ©licieux!", lang: "fr-FR" },
            "paella": { text: "Paella sabrosa y colorida", lang: "es-ES" },
            "pretzel": { text: "Frische, salzige Brezel", lang: "de-DE" },
            "dumpling": { text: "æ–°é²œç¾å‘³çš„é¥ºå­", lang: "zh-CN" }
        };

        const foodItems = ["pancakes", "waffles", "eggs", "bacon", "croissant", "baguette", "cereal", "toast", "avocado", "burger", "pizza", "sandwich", "salad", "taco", "fries", "pretzel", "noodles", "rice ball", "steak", "chicken", "pasta", "curry", "sushi", "paella", "dumpling", "lobster", "rice", "cake", "ice cream", "cherries", "donut", "cookie"];
        const drinkItems = ["coffee", "milk", "juice", "tea", "bubble tea", "soda", "water", "lemonade", "coconut water", "wine"];
        const fruitItems = ["strawberry", "banana", "grapes", "apple", "watermelon", "orange", "pineapple", "kiwi", "cherries"];


        // =================================================================================
        // --- 2. AUDIO & SOUND EFFECTS ---
        // =================================================================================
        
        let audioCtx;
        function initAudio() {
            if (!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        }

        function playTone(freq, duration, type = 'sine') {
            if (!audioCtx) return;
            const osc1 = audioCtx.createOscillator();
            const osc2 = audioCtx.createOscillator();
            const gain = audioCtx.createGain();

            osc1.frequency.value = freq;
            osc2.frequency.value = freq * 1.015;
            osc1.type = osc2.type = type;

            gain.gain.setValueAtTime(0.2, audioCtx.currentTime);
            gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + duration);
            
            osc1.connect(gain);
            osc2.connect(gain);
            gain.connect(audioCtx.destination);
            
            osc1.start();
            osc2.start();
            
            osc1.stop(audioCtx.currentTime + duration);
            osc2.stop(audioCtx.currentTime + duration);
        }
        
        // =================================================================================
        // --- 3. SPEECH SYNTHESIS & VOICES (REFACTORED) ---
        // =================================================================================

        // Map of preferred voice names for different languages to improve selection.
        const multilingualVoiceMap = {
            'de-DE': ['Seraphina', 'Florian', 'Microsoft Katja Online (Natural) - German (Germany)'],
            'es-ES': ['Sonia', 'Microsoft Elvira Online (Natural) - Spanish (Spain)'],
            'fr-FR': ['Remy', 'Nicolas', 'Microsoft Denise Online (Natural) - French (France)'],
            'zh-CN': ['Xiaoxiao', 'Microsoft Xiaoxiao Online (Natural) - Chinese (Mainland)'],
            'en-AU': ['Natasha', 'Microsoft Natasha Online (Natural) - English (Australia)']
        };

        // Fallback English voices if specific multilingual ones aren't found.
        const fallbackEnglishVoices = [
            'Ava',
            'Jenny',
            'Microsoft Ava Multilingual Online (Natural) - English (United States)',
            'Microsoft Andrew Multilingual Online (Natural) - English (United States)',
        ];

        let allVoices = [];

        // Loads available voices from the browser's speech synthesis engine.
        function loadVoices() {
            allVoices = speechSynthesis.getVoices();
            if (allVoices.length === 0) {
                // Voices might load asynchronously, so we retry if they're not ready.
                setTimeout(loadVoices, 100);
            }
        }

        // Finds the best available voice object for a given language code.
        function getVoice(lang, preferredNames = []) {
            if (allVoices.length === 0) return null;

            // 1. Try to find a preferred voice by name for the given language.
            for (const name of preferredNames) {
                const match = allVoices.find(v => v.lang === lang && v.name.toLowerCase().includes(name.toLowerCase()));
                if (match) return match;
            }

            // 2. If no preferred voice is found, find the first available voice for that language.
            const langMatch = allVoices.find(v => v.lang === lang);
            if (langMatch) return langMatch;
            
            // 3. If no voice for the specific language is found, return null.
            return null;
        }

        // Speaks text using the best available voice for the specified language.
        function speakText(text, lang = 'en-US', onEndCallback = null) {
            if (!('speechSynthesis' in window) || allVoices.length === 0) {
                console.warn("Speech synthesis not available or voices not loaded.");
                return;
            }
            
            speechSynthesis.cancel(); // Stop any currently playing speech.

            let voice;
            if (lang.startsWith('en')) {
                // Use the specific English list for en-US, en-AU, etc.
                const englishVoices = lang === 'en-AU' ? multilingualVoiceMap['en-AU'] : fallbackEnglishVoices;
                voice = getVoice(lang, englishVoices);
            } else {
                voice = getVoice(lang, multilingualVoiceMap[lang] || []);
            }
            
            // If the target language voice isn't found, fallback to a generic English voice.
            if (!voice) {
                voice = getVoice('en-US', fallbackEnglishVoices);
            }

            if (!voice) {
                console.warn(`No voice found for lang '${lang}' or fallback 'en-US'.`);
                if(onEndCallback) onEndCallback(); // Ensure callback still fires if no voice is found.
                return;
            }

            const utterance = new SpeechSynthesisUtterance(text);
            utterance.voice = voice;
            utterance.lang = voice.lang; // Set lang to match the selected voice
            utterance.rate = 0.85; 
            utterance.pitch = 1.2;
            utterance.volume = 1;

            if (onEndCallback) utterance.onend = onEndCallback;

            speechSynthesis.speak(utterance);
        }

        // =================================================================================
        // --- 4. CORE APPLICATION LOGIC (INIT, PAGE NAVIGATION) ---
        // =================================================================================
        
        function init() {
            updateProgress();
            generatePriceControls();
            updateStaff();
            loadVoices(); // Initial call to load voices
            createFloatingEmojis();
            initDragAndDrop();
        }
        
        function showNotification(message) {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.style.display = 'block';
            setTimeout(() => notification.style.opacity = 1, 10); // Fade in

            setTimeout(() => {
                notification.style.opacity = 0;
                setTimeout(() => notification.style.display = 'none', 500); // Fade out
            }, 3000);
        }

        function createFloatingEmojis() {
            const container = document.getElementById('background-emojis');
            const emojis = ['ğŸ¥', 'ğŸ”', 'ğŸ•', 'ğŸ“', 'ğŸ°', 'ğŸ£', 'ğŸŒ®', 'ğŸ©', 'ğŸª', 'ğŸ‰', 'â˜•ï¸', 'ğŸ§‹'];
            for (let i = 0; i < 15; i++) {
                const emoji = document.createElement('div');
                emoji.className = 'floating-emoji';
                emoji.textContent = emojis[Math.floor(Math.random() * emojis.length)];
                emoji.style.left = `${Math.random() * 100}vw`;
                emoji.style.animationDuration = `${15 + Math.random() * 15}s`;
                emoji.style.animationDelay = `${Math.random() * 10}s`;
                container.appendChild(emoji);
            }
        }

        function updateNames() {
            restaurant.owner = document.getElementById('ownerName').value;
            restaurant.restaurantName = document.getElementById('restaurantName').value;
            if (restaurant.restaurantName) {
                document.getElementById('mainTitle').textContent = `ğŸ½ï¸ ${restaurant.restaurantName} ğŸ¨`;
                document.getElementById('mainSubtitle').textContent = `${restaurant.owner}'s Amazing Restaurant!`;
            }
            updateProgress();
        }
        
        function showPage(event, pageId) {
            initAudio();
            playTone(880, 0.1, 'triangle');
            document.querySelectorAll('.page').forEach(page => page.classList.remove('active'));
            document.querySelectorAll('.nav-btn').forEach(btn => btn.classList.remove('active'));
            document.getElementById(pageId).classList.add('active');
            event.currentTarget.classList.add('active');
            currentPage = pageId;

            let textToSpeak = '';
            
            const pageGreetings = {
                breakfast: "Time to make a yummy breakfast menu!",
                lunch: "What should we have for lunch?",
                dinner: "Let's create a delicious dinner!",
                prices: "Let's set the prices.",
                times: "When will your restaurant be open?",
                staff: "Let's hire an amazing team!",
                summary: "Wow! Look at your amazing restaurant!"
            };

            switch(pageId) {
                case 'setup':
                    textToSpeak = "Let's get your restaurant set up!";
                    break;
                case 'menu':
                    const missionElement = document.getElementById('missionText');
                    if (missionElement) {
                        const missionClone = missionElement.cloneNode(true);
                        missionClone.querySelectorAll('span').forEach(span => span.remove());
                        textToSpeak = missionClone.textContent.trim().replace(/\s\s+/g, ' ');
                    }
                    break;
                default:
                    textToSpeak = pageGreetings[pageId];
                    break;
            }

            if (textToSpeak) {
                speakText(textToSpeak); // Simplified call, defaults to en-US
            }

            if (pageId === 'prices') generatePriceControls();
            if (pageId === 'summary') generateSummary();
            updateProgress();
        }

        // =================================================================================
        // --- 5. DRAG & DROP FUNCTIONALITY ---
        // =================================================================================
        
        let draggingElement = null;
        let ghostElement = null;
        let touchOffsetX = 0;
        let touchOffsetY = 0;

        function initDragAndDrop() {
            document.addEventListener('touchstart', handleTouchStart, { passive: false });
            document.addEventListener('touchmove', handleTouchMove, { passive: false });
            document.addEventListener('touchend', handleTouchEnd);
        }

        function allowDrop(ev) { ev.preventDefault(); ev.target.closest('.drop-zone').classList.add('drag-over'); }
        function dragLeave(ev) { ev.target.closest('.drop-zone').classList.remove('drag-over'); }
        function drag(ev) {
            const data = { emoji: ev.target.dataset.emoji, name: ev.target.dataset.name };
            ev.dataTransfer.setData("text/plain", JSON.stringify(data));
        }
        function drop(ev) {
            ev.preventDefault();
            const dropZone = ev.target.closest('.drop-zone');
            dropZone.classList.remove('drag-over');
            const data = JSON.parse(ev.dataTransfer.getData("text/plain"));
            handleDropLogic(dropZone, data);
        }

        function handleTap(event) {
            const data = { 
                emoji: event.currentTarget.dataset.emoji, 
                name: event.currentTarget.dataset.name 
            };
            const activePage = document.querySelector('.page.active');
            if (!activePage || !activePage.querySelector('.drop-zone')) {
                showNotification("Please go to a menu page to add items!");
                return;
            }

            let targetZone;
            // If it's a drink (and not also a fruit), target the 'Drinks' zone.
            if (drinkItems.includes(data.name) && !fruitItems.includes(data.name)) {
                targetZone = activePage.querySelector('.drop-zone[id$="Drinks"]');
            } else {
                // Otherwise (it's a food or a fruit), target the 'Food' zone.
                targetZone = activePage.querySelector('.drop-zone[id$="Food"]');
            }

            if (targetZone) {
                handleDropLogic(targetZone, data);
            }
        }

        function handleTouchStart(e) {
            if (e.target.classList.contains('emoji-item')) {
                e.preventDefault();
                draggingElement = e.target;
                const rect = draggingElement.getBoundingClientRect();
                touchOffsetX = e.touches[0].clientX - rect.left;
                touchOffsetY = e.touches[0].clientY - rect.top;

                ghostElement = draggingElement.cloneNode(true);
                ghostElement.style.position = 'absolute';
                ghostElement.style.zIndex = '1001';
                ghostElement.style.pointerEvents = 'none';
                ghostElement.style.opacity = '0.7';
                ghostElement.style.transform = 'scale(1.2)';
                document.body.appendChild(ghostElement);
                moveGhost(e.touches[0]);
            }
        }

        function handleTouchMove(e) {
            if (draggingElement) {
                e.preventDefault();
                moveGhost(e.touches[0]);
            }
        }

        function handleTouchEnd(e) {
            if (draggingElement) {
                ghostElement.style.display = 'none';
                const elementUnder = document.elementFromPoint(e.changedTouches[0].clientX, e.changedTouches[0].clientY);
                ghostElement.style.display = 'block';
                
                const dropZone = elementUnder ? elementUnder.closest('.drop-zone') : null;
                if (dropZone) {
                    const data = { emoji: draggingElement.dataset.emoji, name: draggingElement.dataset.name };
                    handleDropLogic(dropZone, data);
                }

                document.body.removeChild(ghostElement);
                draggingElement = null;
                ghostElement = null;
                document.querySelectorAll('.drop-zone').forEach(zone => zone.classList.remove('drag-over'));
            }
        }
        
        function moveGhost(touch) {
            if (ghostElement) {
                ghostElement.style.left = `${touch.pageX - touchOffsetX}px`;
                ghostElement.style.top = `${touch.pageY - touchOffsetY}px`;
                ghostElement.style.display = 'none';
                const elementUnder = document.elementFromPoint(touch.clientX, touch.clientY);
                ghostElement.style.display = 'block';
                document.querySelectorAll('.drop-zone').forEach(zone => {
                    zone.classList.toggle('drag-over', zone === elementUnder || zone.contains(elementUnder));
                });
            }
        }
        
        function handleDropLogic(dropZone, data) {
            const isDrinkZone = dropZone.id.toLowerCase().includes("drink");
            const isFoodZone = dropZone.id.toLowerCase().includes("food");

            // Rule: Warn if a non-fruit food is dropped into a drink zone.
            if (isDrinkZone && foodItems.includes(data.name) && !fruitItems.includes(data.name)) {
                showNotification(`âš ï¸ ${data.name} is food, not a drink!`);
                speakText(`${data.name} is food, not a drink!`, 'en-US');
                return; // Stop adding
            }

            // Rule: Warn if a drink is dropped into a food zone (and it's not a fruit).
            if (isFoodZone && drinkItems.includes(data.name) && !fruitItems.includes(data.name)) {
                showNotification(`âš ï¸ ${data.name} is a drink, not food!`);
                speakText(`${data.name} is a drink, not food!`, 'en-US');
                return; // Stop adding
            }

            // Rule: Allow fruits in both zones, but reclassify as a drink if in a drink zone.
            const targetType = (isDrinkZone && fruitItems.includes(data.name)) || drinkItems.includes(data.name) ? "drinks" : "foods";

            const droppedItem = document.createElement('div');
            droppedItem.className = 'dropped-item';
            droppedItem.innerHTML = `${data.emoji} ${data.name}`;
            droppedItem.onclick = () => removeItem(droppedItem, dropZone.id, data);
            
            dropZone.querySelector('.dropped-items').appendChild(droppedItem);
            storeMenuItemWithType(dropZone.id, data, targetType);
            playTone(200, 0.15);

            const description = foodDescriptions[data.name];
            if (description) {
                // Speak the native description for specific food items.
                speakText(description.text, description.lang);
            } else {
                // Speak a generic English phrase for other items.
                const phrases = ["Great choice!", "Yummy!", "Looks delicious!", "Excellent!"];
                const randomPhrase = phrases[Math.floor(Math.random() * phrases.length)];
                speakText(randomPhrase, 'en-US', () => {
                    speakText(data.name, 'en-US');
                });
            }
            updateProgress();
        }

        function removeItem(element, dropZoneId, data) {
            playTone(880, 0.1, 'triangle');
            element.remove();
            removeMenuItem(dropZoneId, data);
            updateProgress();
        }

        // =================================================================================
        // --- 6. UI & DATA UPDATE FUNCTIONS (Menus, Prices, etc.) ---
        // =================================================================================
        
        function getMenuCategory(dropZoneId) {
            if (dropZoneId.includes('breakfast')) return restaurant.breakfast;
            if (dropZoneId.includes('lunch')) return restaurant.lunch;
            if (dropZoneId.includes('dinner')) return restaurant.dinner;
        }
        function storeMenuItemWithType(dropZoneId, data, type) {
            const category = getMenuCategory(dropZoneId);
            if (!category[type].some(item => item.name === data.name)) {
                category[type].push(data);
            }
        }
        function removeMenuItem(dropZoneId, data) {
            const category = getMenuCategory(dropZoneId);
            
            // If it's a fruit, it could be in either the foods or drinks array for the meal.
            if (fruitItems.includes(data.name)) {
                // Try removing from foods first
                let index = category.foods.findIndex(item => item.name === data.name);
                if (index > -1) {
                    category.foods.splice(index, 1);
                    return; // Exit after removing
                }
                // If not in foods, try removing from drinks
                index = category.drinks.findIndex(item => item.name === data.name);
                if (index > -1) {
                    category.drinks.splice(index, 1);
                }
            } else {
                // For non-fruits, the zone type determines the array.
                const type = dropZoneId.toLowerCase().includes('drinks') ? 'drinks' : 'foods';
                const index = category[type].findIndex(item => item.name === data.name);
                if (index > -1) category[type].splice(index, 1);
            }
        }

        function generatePriceControls() {
            const pricesList = document.getElementById('pricesList');
            pricesList.innerHTML = '';
            const allItems = [...restaurant.breakfast.foods, ...restaurant.breakfast.drinks, ...restaurant.lunch.foods, ...restaurant.lunch.drinks, ...restaurant.dinner.foods, ...restaurant.dinner.drinks];
            const uniqueItems = [...new Map(allItems.map(item => [item.name, item])).values()];
            uniqueItems.forEach(item => {
                if (!restaurant.prices[item.name]) restaurant.prices[item.name] = 5;
                const priceControl = document.createElement('div');
                priceControl.className = 'price-controls';
                priceControl.innerHTML = `<span style="font-size: 1.5rem; color: #333;">${item.emoji} ${item.name}</span> <div class="price-dial" onclick="adjustPrice('${item.name}', -1)">-</div> <span style="font-size: 1.3rem; font-weight: bold; color: #333;" id="price-${item.name}">${restaurant.currency.symbol}${restaurant.prices[item.name]}</span> <div class="price-dial" onclick="adjustPrice('${item.name}', 1)">+</div>`;
                pricesList.appendChild(priceControl);
            });
        }

        function adjustPrice(itemName, change) {
            restaurant.prices[itemName] = Math.max(1, (restaurant.prices[itemName] || 5) + change);
            const newPrice = restaurant.prices[itemName];
            document.getElementById(`price-${itemName}`).textContent = `${restaurant.currency.symbol}${newPrice}`;
            
            playTone(523, 0.1); 
            setTimeout(() => playTone(659, 0.3), 100);
            
            speakText(`${itemName}, ${newPrice} ${restaurant.currency.name}`, 'en-US');
        }
        
        function adjustTime(meal, type, change) {
            event.stopPropagation(); 
            let minutes = restaurant.times[meal][type];
            minutes = (minutes + change + 1440) % 1440;
            restaurant.times[meal][type] = minutes;
            const formattedTime = formatTime(minutes);
            document.getElementById(`${meal}-${type}`).textContent = formattedTime;
            speakText(timeToSpeakableText(formattedTime), 'en-US');
        }

        function formatTime(minutes) {
            const hours24 = Math.floor(minutes / 60);
            const mins = minutes % 60;
            const ampm = hours24 >= 12 ? 'PM' : 'AM';
            let hours12 = hours24 % 12;
            hours12 = hours12 ? hours12 : 12; 
            const formattedMins = mins < 10 ? '0' + mins : mins;
            return `${hours12}:${formattedMins} ${ampm}`;
        }
        
        function timeToSpeakableText(timeString) {
            let [time] = timeString.split(' ');
            let [hour, minute] = time.split(':');
            let minuteText = parseInt(minute) === 0 ? "o'clock" : (parseInt(minute) < 10 ? `oh ${parseInt(minute)}` : minute);
            return `${hour} ${minuteText}`;
        }

        function toggleTime(element, timeSlot) {
            playTone(600, 0.1, 'square');
            element.classList.toggle('selected');
            const index = restaurant.openingHours.indexOf(timeSlot);
            if (element.classList.contains('selected')) {
                if (index === -1) restaurant.openingHours.push(timeSlot);
            } else {
                if (index > -1) restaurant.openingHours.splice(index, 1);
            }
            updateProgress();
        }

        function selectStaffCountry(element, role, lang) {
            if (chosenStaffLangs.has(lang) && restaurant.staff[role].lang !== lang) {
                showNotification("This country is already assigned to another staff member.");
                return;
            }

            if (restaurant.staff[role].lang) {
                chosenStaffLangs.delete(restaurant.staff[role].lang);
            }

            restaurant.staff[role].lang = lang;
            chosenStaffLangs.add(lang);
            
            const parentCard = element.closest('.staff-card');
            parentCard.querySelectorAll('.flag-item').forEach(item => item.classList.remove('selected'));
            element.classList.add('selected');
            
            const script = staffScripts[lang];
            
            if (script) {
                speakText(script.english, 'en-US', () => {
                   speakText(script.native, lang);
                });
            }
        }

        function updateStaff() {
            document.querySelectorAll('.staff-input').forEach(input => {
                input.addEventListener('input', (e) => {
                    const role = e.target.dataset.role;
                    restaurant.staff[role].name = e.target.value;
                    updateProgress();
                });
            });
        }

        function updateProgress() {
            document.getElementById('breakfastCount').textContent = restaurant.breakfast.foods.length + restaurant.breakfast.drinks.length;
            document.getElementById('lunchCount').textContent = restaurant.lunch.foods.length + restaurant.lunch.drinks.length;
            document.getElementById('dinnerCount').textContent = restaurant.dinner.foods.length + restaurant.dinner.drinks.length;
            const hiredStaff = Object.values(restaurant.staff).filter(s => s.name.trim() !== "").length;
            document.getElementById('staffCount').textContent = `${hiredStaff}/5`;
            document.getElementById('hoursCount').textContent = `${restaurant.openingHours.length}/4`;
        }

        function generateSummary() {
            const summaryContainer = document.getElementById('restaurantSummary');
            let summaryHTML = '<div class="staff-container">'; 
            
            const createCard = (title, content) => `<div class="summary-card"><div class="summary-title">${title}</div><div class="menu-preview">${content}</div></div>`;
            
            let overviewContent = `<strong>Restaurant Name:</strong> ${restaurant.restaurantName || 'N/A'}<br><strong>Owner:</strong> ${restaurant.owner || 'N/A'}<br><strong>Currency:</strong> ${restaurant.currency.code} (${restaurant.currency.symbol})<br><strong>Opening Hours:</strong> ${restaurant.openingHours.join(', ') || 'N/A'}`;
            summaryHTML += createCard('ğŸª Restaurant Overview', overviewContent);
            
            const createMenuContent = (menu) => {
                const allItems = [...menu.foods, ...menu.drinks];
                return allItems.length > 0 ? allItems.map(item => `<div>${item.emoji} ${item.name} - ${restaurant.currency.symbol}${restaurant.prices[item.name] || 5}</div>`).join('') : null;
            };
            
            const breakfastContent = createMenuContent(restaurant.breakfast);
            if (breakfastContent) summaryHTML += createCard('ğŸŒ… Breakfast Menu', breakfastContent);
            const lunchContent = createMenuContent(restaurant.lunch);
            if (lunchContent) summaryHTML += createCard('â˜€ï¸ Lunch Menu', lunchContent);
            const dinnerContent = createMenuContent(restaurant.dinner);
            if (dinnerContent) summaryHTML += createCard('ğŸŒ™ Dinner Menu', dinnerContent);

            const staffList = Object.entries(restaurant.staff).filter(([, s]) => s.name.trim() !== "");
            if (staffList.length > 0) {
                const staffContent = staffList.map(([role, staff]) => {
                    const emojiMap = { chef: 'ğŸ‘¨â€ğŸ³', cook: 'ğŸ‘©â€ğŸ³', manager: 'ğŸ‘¨â€ğŸ’¼', waiter: 'ğŸ¤µ', waitress: 'ğŸ¤µâ€â™€ï¸'};
                    return `<div>${emojiMap[role]} ${role.charAt(0).toUpperCase() + role.slice(1)}: ${staff.name}</div>`;
                }).join('');
                summaryHTML += createCard('ğŸ‘¥ Our Amazing Team', staffContent);
            }
            summaryHTML += '</div>';
            summaryContainer.innerHTML = summaryHTML;
        }
        
        // =================================================================================
        // --- 7. EVENT LISTENERS ---
        // =================================================================================

        document.addEventListener('DOMContentLoaded', init);
        // This event fires when the browser has loaded the available synthesis voices.
        speechSynthesis.onvoiceschanged = loadVoices;
    </script>
</body>
</html>
