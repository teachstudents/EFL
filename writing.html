<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Writing Adventure Arcade - Enhanced</title>
    <style>
        body {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Comic Sans MS', cursive, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            overflow-x: hidden;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .page {
            display: none;
            animation: fadeIn 0.5s ease-in-out;
        }

        .page.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        .title {
            font-size: 3rem;
            color: #fff;
            text-shadow: 3px 3px 6px rgba(0,0,0,0.3);
            margin-bottom: 10px;
            animation: glow 2s ease-in-out infinite alternate;
        }

        @keyframes glow {
            from { text-shadow: 3px 3px 6px rgba(0,0,0,0.3), 0 0 20px rgba(255,255,255,0.3); }
            to { text-shadow: 3px 3px 6px rgba(0,0,0,0.3), 0 0 30px rgba(255,255,255,0.6); }
        }

        .subtitle {
            font-size: 1.2rem;
            color: #e0e6ff;
            margin-bottom: 20px;
        }

        /* Achievement System */
        .achievement-badges {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .badge {
            background: rgba(255,255,255,0.9);
            border-radius: 50%;
            width: 60px;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            transition: all 0.3s ease;
            position: relative;
            cursor: pointer;
        }

        .badge.earned {
            background: linear-gradient(135deg, #ffd700, #ffed4e);
            animation: badgeGlow 2s ease-in-out infinite alternate;
        }

        .badge.locked {
            opacity: 0.3;
            filter: grayscale(100%);
        }

        @keyframes badgeGlow {
            from { box-shadow: 0 4px 15px rgba(0,0,0,0.2); }
            to { box-shadow: 0 4px 25px rgba(255,215,0,0.6); }
        }

        .badge-tooltip {
            position: absolute;
            bottom: -30px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 5px 10px;
            border-radius: 5px;
            font-size: 0.8rem;
            white-space: nowrap;
            opacity: 0;
            transition: opacity 0.3s ease;
            pointer-events: none;
        }

        .badge:hover .badge-tooltip {
            opacity: 1;
        }

        /* Personalization Panel */
        .personalization-panel {
            background: rgba(255,255,255,0.1);
            border-radius: 15px;
            padding: 15px;
            margin-bottom: 20px;
        }

        .avatar-selector {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 15px;
        }

        .avatar-option {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: 3px solid transparent;
            cursor: pointer;
            font-size: 1.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(255,255,255,0.2);
            transition: all 0.3s ease;
        }

        .avatar-option.selected {
            border-color: #ffd700;
            background: rgba(255,215,0,0.3);
        }

        /* Daily Challenge */
        .daily-challenge {
            background: linear-gradient(135deg, #ff6b35, #f7931e);
            color: white;
            border-radius: 15px;
            padding: 15px;
            margin-bottom: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .daily-challenge:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.3);
        }

        /* Difficulty Selector */
        .difficulty-selector {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 20px;
        }

        .difficulty-btn {
            padding: 8px 16px;
            border: 2px solid rgba(255,255,255,0.3);
            background: rgba(255,255,255,0.1);
            color: white;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
        }

        .difficulty-btn.active {
            background: rgba(255,255,255,0.9);
            color: #333;
            border-color: #ffd700;
        }

        .progress-bar {
            width: 100%;
            height: 20px;
            background: rgba(255,255,255,0.2);
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 30px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #ffd700, #ffed4e);
            width: 0%;
            transition: width 0.8s ease;
            box-shadow: 0 0 10px rgba(255,215,0,0.5);
        }

        .station-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 30px;
            margin-bottom: 30px;
        }

        .station-button {
            background: rgba(255,255,255,0.95);
            border: none;
            border-radius: 20px;
            padding: 30px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            position: relative;
            overflow: hidden;
        }

        .station-button:hover {
            transform: translateY(-10px) scale(1.05);
            box-shadow: 0 20px 40px rgba(0,0,0,0.3);
        }

        .station-button::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255,255,255,0.4), transparent);
            transform: rotate(45deg);
            transition: all 0.6s;
            opacity: 0;
        }

        .station-button:hover::before {
            animation: shimmer 1.5s ease-in-out;
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%) translateY(-100%) rotate(45deg); opacity: 0; }
            50% { opacity: 1; }
            100% { transform: translateX(100%) translateY(100%) rotate(45deg); opacity: 0; }
        }

        .progress-ring {
            position: absolute;
            top: -5px;
            left: -5px;
            right: -5px;
            bottom: -5px;
            border-radius: 20px;
            border: 3px solid transparent;
            transition: all 0.3s ease;
        }

        .progress-ring.partial {
            border-top-color: #ffd700;
            border-right-color: #ffd700;
        }

        .progress-ring.complete {
            border-color: #4CAF50;
            box-shadow: 0 0 15px rgba(76, 175, 80, 0.5);
        }

        .station-icon {
            font-size: 4rem;
            margin-bottom: 15px;
            animation: bounce 2s infinite;
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-10px); }
            60% { transform: translateY(-5px); }
        }

        .station-name {
            font-size: 2rem;
            font-weight: bold;
            color: #333;
            margin-bottom: 10px;
        }

        .station-description {
            color: #666;
            font-size: 1rem;
        }

        .station-progress {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(76, 175, 80, 0.9);
            color: white;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 0.8rem;
            font-weight: bold;
        }

        .game-layout {
            display: grid;
            grid-template-columns: 75% 25%;
            gap: 20px;
            height: calc(100vh - 120px);
            max-height: 700px;
        }

        .center-panel {
            background: rgba(255,255,255,0.95);
            border-radius: 20px;
            padding: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .right-panel {
            background: rgba(255,255,255,0.95);
            border-radius: 20px;
            padding: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        /* Streak Counter */
        .streak-counter {
            text-align: center;
            background: rgba(255,255,255,0.9);
            border-radius: 10px;
            padding: 10px;
            margin-bottom: 15px;
        }

        .streak-number {
            font-size: 2rem;
            font-weight: bold;
            color: #ff6b35;
        }

        .streak-label {
            font-size: 0.9rem;
            color: #666;
        }

        /* Timer Display */
        .timer-display {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(244, 67, 54, 0.9);
            color: white;
            padding: 10px 20px;
            border-radius: 25px;
            font-size: 1.2rem;
            font-weight: bold;
            z-index: 1000;
            display: none;
        }

        .timer-display.active {
            display: block;
            animation: timerPulse 1s ease-in-out infinite alternate;
        }

        @keyframes timerPulse {
            from { transform: scale(1); }
            to { transform: scale(1.05); }
        }

        /* Feedback Messages */
        .feedback-message {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(76, 175, 80, 0.95);
            color: white;
            padding: 20px 30px;
            border-radius: 15px;
            font-size: 1.2rem;
            font-weight: bold;
            z-index: 2000;
            animation: feedbackPop 2s ease-in-out forwards;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            text-align: center;
            max-width: 300px;
        }

        .feedback-message.incorrect {
            background: rgba(244, 67, 54, 0.95);
        }

        @keyframes feedbackPop {
            0% { opacity: 0; transform: translate(-50%, -50%) scale(0.5); }
            20% { opacity: 1; transform: translate(-50%, -50%) scale(1.1); }
            80% { opacity: 1; transform: translate(-50%, -50%) scale(1); }
            100% { opacity: 0; transform: translate(-50%, -50%) scale(0.9); }
        }

        /* Adaptive Hints */
        .adaptive-hint {
            background: rgba(255, 235, 59, 0.9);
            border-left: 4px solid #ffc107;
            padding: 12px;
            margin: 10px 0;
            border-radius: 5px;
            font-size: 0.9rem;
            animation: hintSlide 0.5s ease-out;
        }

        @keyframes hintSlide {
            from { opacity: 0; transform: translateX(-20px); }
            to { opacity: 1; transform: translateX(0); }
        }

        .mnemonic-display {
            text-align: center;
            margin-bottom: 15px;
        }

        .mnemonic-letter {
            display: block;
            font-size: 1.8rem;
            font-weight: bold;
            color: #667eea;
            margin: 5px 0;
            cursor: pointer;
            transition: all 0.3s ease;
            padding: 6px;
            border-radius: 8px;
        }

        .mnemonic-letter:hover {
            background: rgba(102, 126, 234, 0.1);
            transform: scale(1.1);
        }

        .mnemonic-meaning {
            font-size: 0.9rem;
            color: #333;
            margin-top: 3px;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .mnemonic-meaning.show {
            opacity: 1;
        }

        .drag-item {
            background: linear-gradient(135deg, #4CAF50, #45a049);
            color: white;
            padding: 15px 20px;
            border-radius: 25px;
            margin: 8px;
            cursor: grab;
            display: block;
            font-weight: bold;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            transition: all 0.3s ease;
            user-select: none;
            position: relative;
            text-align: center;
        }

        .drag-item:hover {
            transform: scale(1.05);
            box-shadow: 0 6px 20px rgba(0,0,0,0.3);
        }

        .drag-item:active {
            cursor: grabbing;
            transform: scale(0.95);
        }

        .drag-item.used {
            opacity: 0.3;
            pointer-events: none;
            transform: scale(0.8);
        }

        .drop-zone {
            background: rgba(76, 175, 80, 0.1);
            border: 3px dashed #4caf50;
            border-radius: 15px;
            padding: 8px;
            margin: 3px 0;
            min-height: 35px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            position: relative;
        }

        .drop-zone.drag-over {
            background: rgba(76, 175, 80, 0.2);
            border-color: #2e7d32;
            transform: scale(1.02);
        }

        .drop-zone.correct {
            background: rgba(76, 175, 80, 0.3);
            border-color: #2e7d32;
            color: #2e7d32;
            font-weight: bold;
        }

        .drop-zone.incorrect {
            background: rgba(244, 67, 54, 0.3);
            border-color: #d32f2f;
            animation: shake 0.5s ease-in-out;
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }

        .action-button {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 25px;
            font-size: 0.9rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            margin: 5px;
        }

        .action-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.3);
        }

        .score-display {
            color: #333;
            font-weight: bold;
            background: rgba(255,255,255,0.8);
            padding: 5px 12px;
            border-radius: 15px;
            text-align: center;
        }

        .celebration {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1000;
        }

        .confetti {
            position: absolute;
            width: 10px;
            height: 10px;
            background: #ffd700;
            animation: confetti-fall 3s linear forwards;
        }

        @keyframes confetti-fall {
            0% {
                transform: translateY(-100vh) rotate(0deg);
                opacity: 1;
            }
            100% {
                transform: translateY(100vh) rotate(720deg);
                opacity: 0;
            }
        }

        .tips-section {
            margin-top: 15px;
        }

        .tip {
            background: rgba(255, 235, 59, 0.2);
            border-left: 4px solid #ffc107;
            padding: 12px;
            margin: 8px 0;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
        }

        .tip:hover {
            background: rgba(255, 235, 59, 0.3);
            transform: translateX(3px);
        }

        .answer-stages {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 15px;
            flex: 1;
        }

        .stage-container {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 10px;
            border: 2px solid rgba(102, 126, 234, 0.3);
            min-height: 80px;
        }

        .stage-container h4 {
            margin: 0 0 8px 0;
            color: #333;
            text-align: center;
            font-size: 0.9rem;
        }

        /* Social Features */
        .social-panel {
            background: rgba(255,255,255,0.1);
            border-radius: 15px;
            padding: 15px;
            margin-bottom: 20px;
        }

        .share-button {
            background: linear-gradient(135deg, #4267B2, #365899);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 5px;
        }

        .share-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.3);
        }

        @media (max-width: 768px) {
            .game-layout {
                grid-template-columns: 1fr;
                height: auto;
                gap: 15px;
            }
            
            .right-panel {
                order: 2;
                max-height: 200px;
            }
            
            .center-panel {
                order: 1;
                min-height: 400px;
            }
            
            .title {
                font-size: 2rem;
            }
            
            .answer-stages {
                grid-template-columns: 1fr;
            }
            
            .container {
                padding: 10px;
            }

            .achievement-badges {
                gap: 10px;
            }

            .badge {
                width: 50px;
                height: 50px;
                font-size: 1.2rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Timer Display -->
        <div class="timer-display" id="timerDisplay">
            ⏰ <span id="timeLeft">60</span>s
        </div>

        <!-- Main Menu Page -->
        <div class="page active" id="mainMenu">
            <div class="header">
                <h1 class="title">Writing Adventure Arcade</h1>
            </div>

            <div class="station-grid">
                <button class="station-button" onclick="window.game.goToStation('tree')">
                    <div class="progress-ring" id="tree-progress"></div>
                    <div class="station-progress" id="tree-station-progress">0/10</div>
                    <div class="station-icon">🌳</div>
                    <div class="station-name">TREE</div>
                    <div class="station-description">Topic, Reasons, Ending, Examine</div>
                </button>

                <button class="station-button" onclick="window.game.goToStation('stop')">
                    <div class="progress-ring" id="stop-progress"></div>
                    <div class="station-progress" id="stop-station-progress">0/10</div>
                    <div class="station-icon">🛑</div>
                    <div class="station-name">STOP</div>
                    <div class="station-description">Suspend, Take, Organize, Plan</div>
                </button>

                <button class="station-button" onclick="window.game.goToStation('plan')">
                    <div class="progress-ring" id="plan-progress"></div>
                    <div class="station-progress" id="plan-station-progress">0/10</div>
                    <div class="station-icon">📋</div>
                    <div class="station-name">PLAN</div>
                    <div class="station-description">Prompt, List, Add, Number</div>
                </button>

                <button class="station-button" onclick="window.game.goToStation('write')">
                    <div class="progress-ring" id="write-progress"></div>
                    <div class="station-progress" id="write-station-progress">0/10</div>
                    <div class="station-icon">✍️</div>
                    <div class="station-name">WRITE</div>
                    <div class="station-description">Write, Revise, Improve, Transform, Edit</div>
                </button>

                <button class="station-button" onclick="window.game.goToStation('dare')">
                    <div class="progress-ring" id="dare-progress"></div>
                    <div class="station-progress" id="dare-station-progress">0/10</div>
                    <div class="station-icon">⚖️</div>
                    <div class="station-name">DARE</div>
                    <div class="station-description">Develop, Add, Reject, End</div>
                </button>

                <button class="station-button" onclick="window.game.goToStation('answer')">
                    <div class="progress-ring" id="answer-progress"></div>
                    <div class="station-progress" id="answer-station-progress">0/10</div>
                    <div class="station-icon">📝</div>
                    <div class="station-name">ANSWER</div>
                    <div class="station-description">Analyze, Notice, Set up, Work in, Engineer, Review</div>
                </button>
            </div>


        </div>

        <!-- TREE Station Page -->
        <div class="page" id="treePage">
            <div class="game-layout">
                <div class="center-panel">
                    <div class="drop-zone" data-type="topic">
                        <span class="placeholder">🎯 Drop Topic Sentence Here</span>
                    </div>
                    <div class="drop-zone" data-type="reason1">
                        <span class="placeholder">💡 Drop First Reason Here</span>
                    </div>
                    <div class="drop-zone" data-type="reason2">
                        <span class="placeholder">💡 Drop Second Reason Here</span>
                    </div>
                    <div class="drop-zone" data-type="ending">
                        <span class="placeholder">🏁 Drop Ending Here</span>
                    </div>

                    <div id="adaptive-hints-tree"></div>

                    <div style="margin-top: 30px;">
                        <h3>Available Options:</h3>
                        <div id="treeItems"></div>
                    </div>
                </div>

                <div class="right-panel">
                    <h2 style="text-align: center; color: #333; margin-bottom: 15px;">🌳 Build Your Argument Tree</h2>
                    
                    <div class="streak-counter">
                        <div class="streak-number" id="tree-streak">0</div>
                        <div class="streak-label">Current Streak</div>
                    </div>
                    
                    <div class="nav-buttons" style="display: flex; gap: 10px; justify-content: center; margin-bottom: 15px;">
                        <button class="action-button" onclick="window.game.nextRound('tree')">Next Challenge</button>
                        <button class="action-button" onclick="window.game.goToStation('main')">Back to Menu</button>
                    </div>
                    <div class="score-display" style="margin-bottom: 15px;">Score: <span id="treeScore">0</span>/10</div>
                    
                    <div class="mnemonic-display">
                        <div class="mnemonic-letter" onclick="window.game.toggleMeaning(this)">
                            T
                            <div class="mnemonic-meaning">Topic Sentence</div>
                        </div>
                        <div class="mnemonic-letter" onclick="window.game.toggleMeaning(this)">
                            R
                            <div class="mnemonic-meaning">Reasons</div>
                        </div>
                        <div class="mnemonic-letter" onclick="window.game.toggleMeaning(this)">
                            E
                            <div class="mnemonic-meaning">Ending</div>
                        </div>
                        <div class="mnemonic-letter" onclick="window.game.toggleMeaning(this)">
                            E
                            <div class="mnemonic-meaning">Examine</div>
                        </div>
                    </div>

                    <h3>💡 Tips</h3>
                    <div class="tips-section">
                        <div class="tip" onclick="window.game.speakText('Topic: Start with a clear main idea that tells your position.')">
                            <strong>Topic:</strong> Start with a clear main idea that tells your position.
                        </div>
                        <div class="tip" onclick="window.game.speakText('Reasons: Give 2-3 strong supporting points with evidence.')">
                            <strong>Reasons:</strong> Give 2-3 strong supporting points with evidence.
                        </div>
                        <div class="tip" onclick="window.game.speakText('Ending: Restate your position and summarize your reasons.')">
                            <strong>Ending:</strong> Restate your position and summarize your reasons.
                        </div>
                        <div class="tip" onclick="window.game.speakText('Examine: Check if your argument makes sense and is convincing.')">
                            <strong>Examine:</strong> Check if your argument makes sense and is convincing.
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- STOP Station Page -->
        <div class="page" id="stopPage">
            <div class="game-layout">
                <div class="center-panel">
                    <div class="drop-zone" data-type="suspend">
                        <span class="placeholder">⏸️ Suspend Judgment</span>
                    </div>
                    <div class="drop-zone" data-type="take">
                        <span class="placeholder">📝 Take a Side</span>
                    </div>
                    <div class="drop-zone" data-type="organize">
                        <span class="placeholder">📊 Organize Ideas</span>
                    </div>
                    <div class="drop-zone" data-type="plan">
                        <span class="placeholder">🎯 Plan to Write</span>
                    </div>

                    <div id="adaptive-hints-stop"></div>

                    <div style="margin-top: 30px;">
                        <h3>Available Options:</h3>
                        <div id="stopItems"></div>
                    </div>
                </div>

                <div class="right-panel">
                    <h2 style="text-align: center; color: #333; margin-bottom: 15px;">🛑 STOP and Think</h2>
                    
                    <div class="streak-counter">
                        <div class="streak-number" id="stop-streak">0</div>
                        <div class="streak-label">Current Streak</div>
                    </div>
                    
                    <div class="nav-buttons" style="display: flex; gap: 10px; justify-content: center; margin-bottom: 15px;">
                        <button class="action-button" onclick="game.nextRound('stop')">Next Challenge</button>
                        <button class="action-button" onclick="game.goToStation('main')">Back to Menu</button>
                    </div>
                    <div class="score-display" style="margin-bottom: 15px;">Score: <span id="stopScore">0</span>/10</div>
                    
                    <div class="mnemonic-display">
                        <div class="mnemonic-letter" onclick="game.toggleMeaning(this)">
                            S
                            <div class="mnemonic-meaning">Suspend Judgment</div>
                        </div>
                        <div class="mnemonic-letter" onclick="game.toggleMeaning(this)">
                            T
                            <div class="mnemonic-meaning">Take a Side</div>
                        </div>
                        <div class="mnemonic-letter" onclick="game.toggleMeaning(this)">
                            O
                            <div class="mnemonic-meaning">Organize Ideas</div>
                        </div>
                        <div class="mnemonic-letter" onclick="game.toggleMeaning(this)">
                            P
                            <div class="mnemonic-meaning">Plan to Write</div>
                        </div>
                    </div>

                    <h3>💡 Tips</h3>
                    <div class="tips-section">
                        <div class="tip" onclick="game.speakText('Suspend: Don\'t rush to judgment. Consider all sides first.')">
                            <strong>Suspend:</strong> Don't rush to judgment. Consider all sides first.
                        </div>
                        <div class="tip" onclick="game.speakText('Take: Choose your position based on the strongest evidence.')">
                            <strong>Take:</strong> Choose your position based on the strongest evidence.
                        </div>
                        <div class="tip" onclick="game.speakText('Organize: Group similar ideas together logically.')">
                            <strong>Organize:</strong> Group similar ideas together logically.
                        </div>
                        <div class="tip" onclick="game.speakText('Plan: Create an outline before you start writing.')">
                            <strong>Plan:</strong> Create an outline before you start writing.
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- PLAN Station Page -->
        <div class="page" id="planPage">
            <div class="game-layout">
                <div class="center-panel">
                    <div class="drop-zone" data-type="prompt">
                        <span class="placeholder">❓ Drop Prompt Analysis Here</span>
                    </div>
                    <div class="drop-zone" data-type="list">
                        <span class="placeholder">📝 Drop List Ideas Here</span>
                    </div>
                    <div class="drop-zone" data-type="add">
                        <span class="placeholder">➕ Drop Add Details Here</span>
                    </div>
                    <div class="drop-zone" data-type="number">
                        <span class="placeholder">🔢 Drop Number Order Here</span>
                    </div>

                    <div id="adaptive-hints-plan"></div>

                    <div style="margin-top: 30px;">
                        <h3>Available Options:</h3>
                        <div id="planItems"></div>
                    </div>
                </div>

                <div class="right-panel">
                    <h2 style="text-align: center; color: #333; margin-bottom: 15px;">📋 Make Your PLAN</h2>
                    
                    <div class="streak-counter">
                        <div class="streak-number" id="plan-streak">0</div>
                        <div class="streak-label">Current Streak</div>
                    </div>
                    
                    <div class="nav-buttons" style="display: flex; gap: 10px; justify-content: center; margin-bottom: 15px;">
                        <button class="action-button" onclick="game.nextRound('plan')">Next Challenge</button>
                        <button class="action-button" onclick="game.goToStation('main')">Back to Menu</button>
                    </div>
                    <div class="score-display" style="margin-bottom: 15px;">Score: <span id="planScore">0</span>/10</div>
                    
                    <div class="mnemonic-display">
                        <div class="mnemonic-letter" onclick="game.toggleMeaning(this)">
                            P
                            <div class="mnemonic-meaning">Prompt Analysis</div>
                        </div>
                        <div class="mnemonic-letter" onclick="game.toggleMeaning(this)">
                            L
                            <div class="mnemonic-meaning">List Ideas</div>
                        </div>
                        <div class="mnemonic-letter" onclick="game.toggleMeaning(this)">
                            A
                            <div class="mnemonic-meaning">Add Details</div>
                        </div>
                        <div class="mnemonic-letter" onclick="game.toggleMeaning(this)">
                            N
                            <div class="mnemonic-meaning">Number Order</div>
                        </div>
                    </div>

                    <h3>💡 Tips</h3>
                    <div class="tips-section">
                        <div class="tip" onclick="game.speakText('Prompt: Read carefully and identify what you need to do.')">
                            <strong>Prompt:</strong> Read carefully and identify what you need to do.
                        </div>
                        <div class="tip" onclick="game.speakText('List: Brainstorm all your ideas without judging them.')">
                            <strong>List:</strong> Brainstorm all your ideas without judging them.
                        </div>
                        <div class="tip" onclick="game.speakText('Add: Include specific details, examples, and evidence.')">
                            <strong>Add:</strong> Include specific details, examples, and evidence.
                        </div>
                        <div class="tip" onclick="game.speakText('Number: Put your ideas in logical order.')">
                            <strong>Number:</strong> Put your ideas in logical order.
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- WRITE Station Page -->
        <div class="page" id="writePage">
            <div class="game-layout">
                <div class="center-panel">
                    <div class="drop-zone" data-type="write">
                        <span class="placeholder">✍️ Drop Write Step Here</span>
                    </div>
                    <div class="drop-zone" data-type="revise">
                        <span class="placeholder">🔄 Drop Revise Step Here</span>
                    </div>
                    <div class="drop-zone" data-type="improve">
                        <span class="placeholder">⬆️ Drop Improve Step Here</span>
                    </div>
                    <div class="drop-zone" data-type="transform">
                        <span class="placeholder">🔄 Drop Transform Step Here</span>
                    </div>
                    <div class="drop-zone" data-type="edit">
                        <span class="placeholder">✏️ Drop Edit Step Here</span>
                    </div>

                    <div id="adaptive-hints-write"></div>

                    <div style="margin-top: 30px;">
                        <h3>Available Options:</h3>
                        <div id="writeItems"></div>
                    </div>
                </div>

                <div class="right-panel">
                    <h2 style="text-align: center; color: #333; margin-bottom: 15px;">✍️ WRITE Process</h2>
                    
                    <div class="streak-counter">
                        <div class="streak-number" id="write-streak">0</div>
                        <div class="streak-label">Current Streak</div>
                    </div>
                    
                    <div class="nav-buttons" style="display: flex; gap: 10px; justify-content: center; margin-bottom: 15px;">
                        <button class="action-button" onclick="game.nextRound('write')">Next Challenge</button>
                        <button class="action-button" onclick="game.goToStation('main')">Back to Menu</button>
                    </div>
                    <div class="score-display" style="margin-bottom: 15px;">Score: <span id="writeScore">0</span>/10</div>
                    
                    <div class="mnemonic-display">
                        <div class="mnemonic-letter" onclick="game.toggleMeaning(this)">
                            W
                            <div class="mnemonic-meaning">Write First Draft</div>
                        </div>
                        <div class="mnemonic-letter" onclick="game.toggleMeaning(this)">
                            R
                            <div class="mnemonic-meaning">Revise Content</div>
                        </div>
                        <div class="mnemonic-letter" onclick="game.toggleMeaning(this)">
                            I
                            <div class="mnemonic-meaning">Improve Quality</div>
                        </div>
                        <div class="mnemonic-letter" onclick="game.toggleMeaning(this)">
                            T
                            <div class="mnemonic-meaning">Transform Sentences</div>
                        </div>
                        <div class="mnemonic-letter" onclick="game.toggleMeaning(this)">
                            E
                            <div class="mnemonic-meaning">Edit for Errors</div>
                        </div>
                    </div>

                    <h3>💡 Tips</h3>
                    <div class="tips-section">
                        <div class="tip" onclick="game.speakText('Write: Get all your ideas down first, don\'t worry about perfection.')">
                            <strong>Write:</strong> Get all your ideas down first, don't worry about perfection.
                        </div>
                        <div class="tip" onclick="game.speakText('Revise: Read through and fix parts that don\'t make sense.')">
                            <strong>Revise:</strong> Read through and fix parts that don't make sense.
                        </div>
                        <div class="tip" onclick="game.speakText('Improve: Add better words, details, and stronger arguments.')">
                            <strong>Improve:</strong> Add better words, details, and stronger arguments.
                        </div>
                        <div class="tip" onclick="game.speakText('Transform: Change weak sentences into powerful ones.')">
                            <strong>Transform:</strong> Change weak sentences into powerful ones.
                        </div>
                        <div class="tip" onclick="game.speakText('Edit: Check spelling, grammar, and punctuation last.')">
                            <strong>Edit:</strong> Check spelling, grammar, and punctuation last.
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- DARE Station Page -->
        <div class="page" id="darePage">
            <div class="game-layout">
                <div class="center-panel">
                    <div class="drop-zone" data-type="develop">
                        <span class="placeholder">🌱 Drop Develop Step Here</span>
                    </div>
                    <div class="drop-zone" data-type="add">
                        <span class="placeholder">➕ Drop Add Evidence Here</span>
                    </div>
                    <div class="drop-zone" data-type="reject">
                        <span class="placeholder">❌ Drop Reject Weak Ideas Here</span>
                    </div>
                    <div class="drop-zone" data-type="end">
                        <span class="placeholder">🏁 Drop End Strong Here</span>
                    </div>

                    <div id="adaptive-hints-dare"></div>

                    <div style="margin-top: 30px;">
                        <h3>Available Options:</h3>
                        <div id="dareItems"></div>
                    </div>
                </div>

                <div class="right-panel">
                    <h2 style="text-align: center; color: #333; margin-bottom: 15px;">⚖️ DARE to Improve</h2>
                    
                    <div class="streak-counter">
                        <div class="streak-number" id="dare-streak">0</div>
                        <div class="streak-label">Current Streak</div>
                    </div>
                    
                    <div class="nav-buttons" style="display: flex; gap: 10px; justify-content: center; margin-bottom: 15px;">
                        <button class="action-button" onclick="game.nextRound('dare')">Next Challenge</button>
                        <button class="action-button" onclick="game.goToStation('main')">Back to Menu</button>
                    </div>
                    <div class="score-display" style="margin-bottom: 15px;">Score: <span id="dareScore">0</span>/10</div>
                    
                    <div class="mnemonic-display">
                        <div class="mnemonic-letter" onclick="game.toggleMeaning(this)">
                            D
                            <div class="mnemonic-meaning">Develop Ideas</div>
                        </div>
                        <div class="mnemonic-letter" onclick="game.toggleMeaning(this)">
                            A
                            <div class="mnemonic-meaning">Add Evidence</div>
                        </div>
                        <div class="mnemonic-letter" onclick="game.toggleMeaning(this)">
                            R
                            <div class="mnemonic-meaning">Reject Weak Points</div>
                        </div>
                        <div class="mnemonic-letter" onclick="game.toggleMeaning(this)">
                            E
                            <div class="mnemonic-meaning">End Strongly</div>
                        </div>
                    </div>

                    <h3>💡 Tips</h3>
                    <div class="tips-section">
                        <div class="tip" onclick="game.speakText('Develop: Expand your main ideas with more details and explanation.')">
                            <strong>Develop:</strong> Expand your main ideas with more details and explanation.
                        </div>
                        <div class="tip" onclick="game.speakText('Add: Include facts, statistics, examples, and expert opinions.')">
                            <strong>Add:</strong> Include facts, statistics, examples, and expert opinions.
                        </div>
                        <div class="tip" onclick="game.speakText('Reject: Remove ideas that don\'t support your main argument.')">
                            <strong>Reject:</strong> Remove ideas that don't support your main argument.
                        </div>
                        <div class="tip" onclick="game.speakText('End: Finish with a memorable and powerful conclusion.')">
                            <strong>End:</strong> Finish with a memorable and powerful conclusion.
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ANSWER Station Page -->
        <div class="page" id="answerPage">
            <div class="game-layout">
                <div class="center-panel">
                    <div class="drop-zone" data-type="analyze">
                        <span class="placeholder">🔍 Drop Analyze Step Here</span>
                    </div>
                    <div class="drop-zone" data-type="notice">
                        <span class="placeholder">👀 Drop Notice Step Here</span>
                    </div>
                    <div class="drop-zone" data-type="setup">
                        <span class="placeholder">🏗️ Drop Set Up Step Here</span>
                    </div>
                    <div class="drop-zone" data-type="workin">
                        <span class="placeholder">⚙️ Drop Work In Step Here</span>
                    </div>
                    <div class="drop-zone" data-type="engineer">
                        <span class="placeholder">🔧 Drop Engineer Step Here</span>
                    </div>
                    <div class="drop-zone" data-type="review">
                        <span class="placeholder">✅ Drop Review Step Here</span>
                    </div>

                    <div id="adaptive-hints-answer"></div>

                    <div style="margin-top: 30px;">
                        <h3>Available Options:</h3>
                        <div id="answerItems"></div>
                    </div>
                </div>

                <div class="right-panel">
                    <h2 style="text-align: center; color: #333; margin-bottom: 15px;">📝 ANSWER Strategy</h2>
                    
                    <div class="streak-counter">
                        <div class="streak-number" id="answer-streak">0</div>
                        <div class="streak-label">Current Streak</div>
                    </div>
                    
                    <div class="nav-buttons" style="display: flex; gap: 10px; justify-content: center; margin-bottom: 15px;">
                        <button class="action-button" onclick="game.nextRound('answer')">Next Challenge</button>
                        <button class="action-button" onclick="game.goToStation('main')">Back to Menu</button>
                    </div>
                    <div class="score-display" style="margin-bottom: 15px;">Score: <span id="answerScore">0</span>/10</div>
                    
                    <div class="mnemonic-display">
                        <div class="mnemonic-letter" onclick="game.toggleMeaning(this)">
                            A
                            <div class="mnemonic-meaning">Analyze Question</div>
                        </div>
                        <div class="mnemonic-letter" onclick="game.toggleMeaning(this)">
                            N
                            <div class="mnemonic-meaning">Notice Key Words</div>
                        </div>
                        <div class="mnemonic-letter" onclick="game.toggleMeaning(this)">
                            S
                            <div class="mnemonic-meaning">Set Up Response</div>
                        </div>
                        <div class="mnemonic-letter" onclick="game.toggleMeaning(this)">
                            W
                            <div class="mnemonic-meaning">Work In Requirements</div>
                        </div>
                        <div class="mnemonic-letter" onclick="game.toggleMeaning(this)">
                            E
                            <div class="mnemonic-meaning">Engineer Complete Answer</div>
                        </div>
                        <div class="mnemonic-letter" onclick="game.toggleMeaning(this)">
                            R
                            <div class="mnemonic-meaning">Review Your Work</div>
                        </div>
                    </div>

                    <h3>💡 Tips</h3>
                    <div class="tips-section">
                        <div class="tip" onclick="game.speakText('Analyze: Break down the question to understand what it\'s really asking.')">
                            <strong>Analyze:</strong> Break down the question to understand what it's really asking.
                        </div>
                        <div class="tip" onclick="game.speakText('Notice: Look for action words like explain, compare, or describe.')">
                            <strong>Notice:</strong> Look for action words like explain, compare, or describe.
                        </div>
                        <div class="tip" onclick="game.speakText('Set up: Plan how you\'ll organize your complete response.')">
                            <strong>Set up:</strong> Plan how you'll organize your complete response.
                        </div>
                        <div class="tip" onclick="game.speakText('Work in: Make sure you address all parts of the question.')">
                            <strong>Work in:</strong> Make sure you address all parts of the question.
                        </div>
                        <div class="tip" onclick="game.speakText('Engineer: Build a thorough answer that covers everything asked.')">
                            <strong>Engineer:</strong> Build a thorough answer that covers everything asked.
                        </div>
                        <div class="tip" onclick="game.speakText('Review: Check that you answered the question completely.')">
                            <strong>Review:</strong> Check that you answered the question completely.
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="celebration" id="celebration"></div>

    <script>
        class WritingArcade {
            constructor() {
                this.currentStation = 'main';
                this.difficulty = 'easy';
                this.selectedAvatar = '🧑‍🎓';
                this.scores = {
                    tree: 0, stop: 0, plan: 0, write: 0, dare: 0, answer: 0
                };
                this.streaks = {
                    tree: 0, stop: 0, plan: 0, write: 0, dare: 0, answer: 0
                };
                this.currentRound = {
                    tree: 0, stop: 0, plan: 0, write: 0, dare: 0, answer: 0
                };
                this.achievements = {
                    firstWin: false,
                    streak5: false,
                    perfectRound: false,
                    speedDemon: false,
                    writingMaster: false
                };
                this.wrongAttempts = {};
                this.roundStartTime = null;
                this.timerInterval = null;
                this.challengeMode = false;
                this.currentVoice = 'Ava';
                this.init();
            }

            init() {
                this.setupDragAndDrop();
                this.updateProgress();
                this.updateAchievements();
                this.initTTS();
                this.loadUserData();
            }

            // Enhanced feedback system
            showFeedback(isCorrect, message = null) {
                const feedbackDiv = document.createElement('div');
                feedbackDiv.className = `feedback-message ${isCorrect ? '' : 'incorrect'}`;
                
                if (message) {
                    feedbackDiv.textContent = message;
                } else if (isCorrect) {
                    const positiveMessages = [
                        "Excellent reasoning! 🌟",
                        "Perfect logic! 🎯",
                        "You're thinking like a writer! ✍️",
                        "Outstanding work! 🏆",
                        "Brilliant choice! 💡",
                        "You've got this! 🚀"
                    ];
                    feedbackDiv.textContent = positiveMessages[Math.floor(Math.random() * positiveMessages.length)];
                } else {
                    const station = this.currentStation;
                    const helpfulHints = {
                        tree: "Remember TREE: Topic sentence states your main argument clearly!",
                        stop: "Think STOP: Take time to consider all sides before choosing!",
                        plan: "Follow PLAN: Start by understanding what the prompt asks!",
                        write: "Use WRITE: Get your ideas down first, then improve them!",
                        dare: "Apply DARE: Strong arguments need solid evidence!",
                        answer: "Remember ANSWER: Look for action words in the prompt!"
                    };
                    feedbackDiv.textContent = helpfulHints[station] || "Try again! Think about the strategy.";
                }
                
                document.body.appendChild(feedbackDiv);
                setTimeout(() => feedbackDiv.remove(), 2000);
            }

            // Adaptive hint system
            showAdaptiveHint(station) {
                const attempts = this.wrongAttempts[station] || 0;
                if (attempts < 2) return;

                const hintContainer = document.getElementById(`adaptive-hints-${station}`);
                if (!hintContainer) return;

                const hints = {
                    tree: [
                        "💡 Hint: Look for the sentence that clearly states the main argument or position.",
                        "💡 Hint: Reasons should provide evidence or support for your main idea.",
                        "💡 Hint: The ending should restate your position and wrap up your argument."
                    ],
                    stop: [
                        "💡 Hint: 'Suspend' means to pause and not rush to judgment.",
                        "💡 Hint: 'Take a side' means choosing your position after considering options.",
                        "💡 Hint: 'Organize' means grouping similar ideas together logically."
                    ],
                    plan: [
                        "💡 Hint: Start by understanding what the writing task is asking you to do.",
                        "💡 Hint: List all your ideas first, then organize them later.",
                        "💡 Hint: Add specific details and evidence to support your points."
                    ],
                    write: [
                        "💡 Hint: Write your first draft quickly without worrying about perfection.",
                        "💡 Hint: Revise means to read through and fix unclear parts.",
                        "💡 Hint: Edit comes last - check spelling, grammar, and punctuation."
                    ],
                    dare: [
                        "💡 Hint: Develop means to expand your ideas with more details.",
                        "💡 Hint: Add evidence like facts, statistics, and examples.",
                        "💡 Hint: Reject weak points that don't support your argument."
                    ],
                    answer: [
                        "💡 Hint: Analyze the question by breaking it down into parts.",
                        "💡 Hint: Notice action words like 'explain', 'compare', or 'describe'.",
                        "💡 Hint: Review means checking that you answered everything asked."
                    ]
                };

                const stationHints = hints[station] || [];
                if (stationHints.length === 0) return;

                const hintDiv = document.createElement('div');
                hintDiv.className = 'adaptive-hint';
                hintDiv.textContent = stationHints[Math.min(attempts - 2, stationHints.length - 1)];
                
                hintContainer.appendChild(hintDiv);
                setTimeout(() => hintDiv.remove(), 5000);
            }

            // Achievement system
            checkAchievements() {
                // First Win
                if (!this.achievements.firstWin && Object.values(this.scores).some(score => score > 0)) {
                    this.unlockAchievement('firstWin', 'First Victory! 🏆');
                }

                // 5-Win Streak
                const maxStreak = Math.max(...Object.values(this.streaks));
                if (!this.achievements.streak5 && maxStreak >= 5) {
                    this.unlockAchievement('streak5', 'Amazing 5-Win Streak! 🔥');
                }

                // Perfect Round (all correct on first try)
                if (!this.achievements.perfectRound && this.roundStartTime) {
                    const allZones = document.querySelectorAll(`#${this.currentStation}Page .drop-zone`);
                    const correctZones = document.querySelectorAll(`#${this.currentStation}Page .drop-zone.correct`);
                    if (allZones.length === correctZones.length && (this.wrongAttempts[this.currentStation] || 0) === 0) {
                        this.unlockAchievement('perfectRound', 'Perfect Round! ⭐');
                    }
                }

                // Speed Demon (complete round in under 30 seconds)
                if (!this.achievements.speedDemon && this.roundStartTime) {
                    const timeElapsed = (Date.now() - this.roundStartTime) / 1000;
                    if (timeElapsed < 30) {
                        this.unlockAchievement('speedDemon', 'Speed Demon! ⚡');
                    }
                }

                // Writing Master (complete all stations)
                const totalScore = Object.values(this.scores).reduce((a, b) => a + b, 0);
                if (!this.achievements.writingMaster && totalScore >= 60) {
                    this.unlockAchievement('writingMaster', 'Writing Master! 👑');
                }
            }

            unlockAchievement(achievement, message) {
                this.achievements[achievement] = true;
                this.updateAchievements();
                this.showFeedback(true, message);
                this.createCelebration();
                this.saveUserData();
            }

            updateAchievements() {
                const badges = {
                    'firstWin': 'badge-first-win',
                    'streak5': 'badge-streak',
                    'perfectRound': 'badge-perfect',
                    'speedDemon': 'badge-speed',
                    'writingMaster': 'badge-master'
                };

                Object.keys(badges).forEach(achievement => {
                    const badge = document.getElementById(badges[achievement]);
                    if (badge) {
                        if (this.achievements[achievement]) {
                            badge.classList.remove('locked');
                            badge.classList.add('earned');
                        }
                    }
                });
            }

            // Difficulty and challenge modes
            setDifficulty(level) {
                this.difficulty = level;
                document.querySelectorAll('.difficulty-btn').forEach(btn => btn.classList.remove('active'));
                event.target.classList.add('active');
                
                if (level === 'challenge') {
                    this.challengeMode = true;
                    this.showFeedback(true, 'Challenge Mode: 60 seconds per round! ⏰');
                } else {
                    this.challengeMode = false;
                }
            }

            startTimer() {
                if (!this.challengeMode) return;
                
                let timeLeft = 60;
                const timerDisplay = document.getElementById('timerDisplay');
                const timeLeftSpan = document.getElementById('timeLeft');
                
                timerDisplay.classList.add('active');
                
                this.timerInterval = setInterval(() => {
                    timeLeft--;
                    timeLeftSpan.textContent = timeLeft;
                    
                    if (timeLeft <= 10) {
                        timerDisplay.style.background = 'rgba(244, 67, 54, 0.9)';
                    }
                    
                    if (timeLeft <= 0) {
                        this.timeUp();
                    }
                }, 1000);
            }

            stopTimer() {
                if (this.timerInterval) {
                    clearInterval(this.timerInterval);
                    this.timerInterval = null;
                }
                document.getElementById('timerDisplay').classList.remove('active');
            }

            timeUp() {
                this.stopTimer();
                this.showFeedback(false, 'Time\'s up! Try the next challenge! ⏰');
                setTimeout(() => this.nextRound(this.currentStation), 2000);
            }

            // Personalization features
            selectAvatar(avatar) {
                this.selectedAvatar = avatar;
                document.querySelectorAll('.avatar-option').forEach(option => {
                    option.classList.remove('selected');
                });
                document.querySelector(`[data-avatar="${avatar}"]`).classList.add('selected');
                this.saveUserData();
            }

            // Social features
            shareProgress() {
                const totalScore = Object.values(this.scores).reduce((a, b) => a + b, 0);
                const message = `I just scored ${totalScore}/60 points in Writing Adventure Arcade! 🎮✍️ #WritingSkills #Education`;
                
                if (navigator.share) {
                    navigator.share({
                        title: 'Writing Adventure Arcade',
                        text: message,
                        url: window.location.href
                    });
                } else {
                    // Fallback for browsers without native sharing
                    navigator.clipboard.writeText(message).then(() => {
                        this.showFeedback(true, 'Progress copied to clipboard! 📋');
                    });
                }
            }

            viewLeaderboard() {
                // Simulated leaderboard - in real app would connect to backend
                const leaderboard = [
                    { name: 'Writing Wizard', score: 58, avatar: '🧙‍♂️' },
                    { name: 'Grammar Guru', score: 55, avatar: '👩‍🏫' },
                    { name: 'Story Master', score: 52, avatar: '📚' },
                    { name: 'You', score: Object.values(this.scores).reduce((a, b) => a + b, 0), avatar: this.selectedAvatar }
                ];
                
                leaderboard.sort((a, b) => b.score - a.score);
                
                let message = '🏆 Leaderboard 🏆\n\n';
                leaderboard.forEach((player, index) => {
                    const medal = index === 0 ? '🥇' : index === 1 ? '🥈' : index === 2 ? '🥉' : '   ';
                    message += `${medal} ${player.avatar} ${player.name}: ${player.score}/60\n`;
                });
                
                alert(message);
            }

            // Daily challenge system
            startDailyChallenge() {
                const challenges = [
                    { station: 'tree', topic: 'Should schools have longer summer breaks?', bonus: 5 },
                    { station: 'stop', topic: 'Is social media good for teenagers?', bonus: 5 },
                    { station: 'plan', topic: 'How can we protect the environment?', bonus: 5 },
                    { station: 'write', topic: 'What makes a good friend?', bonus: 5 },
                    { station: 'dare', topic: 'Should students choose their own classes?', bonus: 5 },
                    { station: 'answer', topic: 'How can technology help learning?', bonus: 5 }
                ];
                
                const today = new Date().getDate() % challenges.length;
                const challenge = challenges[today];
                
                this.challengeMode = true;
                this.showFeedback(true, `Daily Challenge: ${challenge.topic} (+${challenge.bonus} bonus points!)`);
                setTimeout(() => {
                    this.goToStation(challenge.station);
                }, 2000);
            }

            // Enhanced drag and drop with better feedback
            handleDrop(zone, data) {
                if (zone.classList.contains('correct')) return;

                const isCorrect = this.checkCorrectPlacement(zone, data);
                
                if (isCorrect) {
                    zone.innerHTML = data.text;
                    zone.classList.add('correct');
                    this.scores[this.currentStation]++;
                    this.streaks[this.currentStation]++;
                    this.updateScore();
                    this.updateStationProgress();
                    this.showFeedback(true);
                    this.playSuccessSound();
                    this.createSparkles(zone);
                    
                    // Find and remove the dragged item from available options
                    const draggedItem = Array.from(document.querySelectorAll('.drag-item')).find(item => {
                        return item.textContent === data.text && !item.classList.contains('used');
                    });
                    if (draggedItem) {
                        draggedItem.remove();
                    }
                    
                    this.checkRoundCompletion();
                    this.checkAchievements();
                } else {
                    zone.classList.add('incorrect');
                    this.wrongAttempts[this.currentStation] = (this.wrongAttempts[this.currentStation] || 0) + 1;
                    this.streaks[this.currentStation] = 0; // Reset streak on wrong answer
                    this.showFeedback(false);
                    this.showAdaptiveHint(this.currentStation);
                    
                    setTimeout(() => {
                        zone.classList.remove('incorrect');
                    }, 500);
                }
            }

            // Enhanced station progress tracking
            updateStationProgress() {
                const station = this.currentStation;
                const progressElement = document.getElementById(`${station}-station-progress`);
                const ringElement = document.getElementById(`${station}-progress`);
                
                if (progressElement) {
                    progressElement.textContent = `${this.scores[station]}/10`;
                }
                
                if (ringElement) {
                    if (this.scores[station] >= 10) {
                        ringElement.className = 'progress-ring complete';
                    } else if (this.scores[station] > 0) {
                        ringElement.className = 'progress-ring partial';
                    }
                }
                
                // Update streak display
                const streakElement = document.getElementById(`${station}-streak`);
                if (streakElement) {
                    streakElement.textContent = this.streaks[station];
                }
            }

            // Data persistence
            saveUserData() {
                const userData = {
                    scores: this.scores,
                    streaks: this.streaks,
                    achievements: this.achievements,
                    selectedAvatar: this.selectedAvatar,
                    difficulty: this.difficulty
                };
                localStorage.setItem('writingArcadeData', JSON.stringify(userData));
            }

            loadUserData() {
                const saved = localStorage.getItem('writingArcadeData');
                if (saved) {
                    const userData = JSON.parse(saved);
                    this.scores = userData.scores || this.scores;
                    this.streaks = userData.streaks || this.streaks;
                    this.achievements = userData.achievements || this.achievements;
                    this.selectedAvatar = userData.selectedAvatar || this.selectedAvatar;
                    this.difficulty = userData.difficulty || this.difficulty;
                    
                    this.updateProgress();
                    this.updateAchievements();
                    this.selectAvatar(this.selectedAvatar);
                }
            }

            // Enhanced round management
            loadCurrentRound() {
                if (this.currentStation === 'main') return;

                this.roundStartTime = Date.now();
                this.wrongAttempts[this.currentStation] = 0;
                
                if (this.challengeMode) {
                    this.startTimer();
                }

                const items = this.getItemsForStation(this.currentStation);
                const container = document.getElementById(this.currentStation + 'Items');
                container.innerHTML = '';

                // Shuffle items based on difficulty
                if (this.difficulty === 'hard' || this.difficulty === 'challenge') {
                    this.shuffleArray(items);
                }

                items.forEach(item => {
                    const div = document.createElement('div');
                    div.className = 'drag-item';
                    div.draggable = true;
                    div.textContent = item.text;
                    Object.keys(item.data).forEach(key => {
                        div.dataset[key] = item.data[key];
                    });
                    container.appendChild(div);
                });

                // Reset drop zones
                document.querySelectorAll(`#${this.currentStation}Page .drop-zone`).forEach(zone => {
                    const placeholder = zone.querySelector('.placeholder');
                    if (placeholder) {
                        zone.innerHTML = '<span class="placeholder">' + placeholder.textContent + '</span>';
                    } else {
                        const originalText = this.getOriginalPlaceholder(zone);
                        zone.innerHTML = '<span class="placeholder">' + originalText + '</span>';
                    }
                    zone.classList.remove('correct', 'incorrect');
                });

                this.setupDragAndDrop();
                this.updateStationProgress();
            }

            shuffleArray(array) {
                for (let i = array.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [array[i], array[j]] = [array[j], array[i]];
                }
            }

            // All other existing methods remain the same...
            goToStation(station) {
                this.stopTimer(); // Stop any running timer
                
                document.querySelectorAll('.page').forEach(page => {
                    page.classList.remove('active');
                });

                if (station === 'main') {
                    document.getElementById('mainMenu').classList.add('active');
                    this.currentStation = 'main';
                } else {
                    const targetPage = document.getElementById(station + 'Page');
                    if (targetPage) {
                        targetPage.classList.add('active');
                        this.currentStation = station;
                        this.loadCurrentRound();
                    }
                }
            }

            toggleMeaning(element) {
                const meaning = element.querySelector('.mnemonic-meaning');
                meaning.classList.toggle('show');
                this.playSuccessSound();
            }

            checkCorrectPlacement(zone, data) {
                const zoneType = zone.dataset.type;
                const zoneOrder = zone.dataset.order;
                const zoneStep = zone.dataset.step;
                const zoneStrength = zone.dataset.strength;
                const zoneStage = zone.dataset.stage;

                return (zoneType && data.type === zoneType) ||
                       (zoneOrder && data.order === zoneOrder) ||
                       (zoneStep && data.step === zoneStep) ||
                       (zoneStrength && data.strength === zoneStrength) ||
                       (zoneStage && data.stage === zoneStage);
            }

            checkRoundCompletion() {
                const currentPage = document.querySelector('.page.active');
                const allZones = currentPage.querySelectorAll('.drop-zone');
                const correctZones = currentPage.querySelectorAll('.drop-zone.correct');

                if (allZones.length === correctZones.length) {
                    this.stopTimer();
                    this.createCelebration();
                    this.checkAchievements();
                    this.saveUserData();
                    
                    setTimeout(() => {
                        if (this.currentRound[this.currentStation] < 9) {
                            this.nextRound(this.currentStation);
                        }
                    }, 2000);
                }
            }

            nextRound(station) {
                this.currentRound[station] = (this.currentRound[station] + 1) % 10;
                this.loadCurrentRound();
            }

            updateScore() {
                const scoreElement = document.getElementById(this.currentStation + 'Score');
                if (scoreElement) {
                    scoreElement.textContent = this.scores[this.currentStation];
                }
            }

            updateProgress() {
                const totalScore = Object.values(this.scores).reduce((a, b) => a + b, 0);
                const progressFill = document.getElementById('progressFill');
                if (progressFill) {
                    progressFill.style.width = `${(totalScore / 60) * 100}%`;
                }
            }

            getOriginalPlaceholder(zone) {
                // TREE placeholders
                if (zone.dataset.type === 'topic') return '🎯 Drop Topic Sentence Here';
                if (zone.dataset.type === 'reason1') return '💡 Drop First Reason Here';
                if (zone.dataset.type === 'reason2') return '💡 Drop Second Reason Here';
                if (zone.dataset.type === 'ending') return '🏁 Drop Ending Here';
                
                // STOP placeholders
                if (zone.dataset.type === 'suspend') return '⏸️ Suspend Judgment';
                if (zone.dataset.type === 'take') return '📝 Take a Side';
                if (zone.dataset.type === 'organize') return '📊 Organize Ideas';
                if (zone.dataset.type === 'plan') return '🎯 Plan to Write';
                
                // PLAN placeholders
                if (zone.dataset.type === 'prompt') return '❓ Drop Prompt Analysis Here';
                if (zone.dataset.type === 'list') return '📝 Drop List Ideas Here';
                if (zone.dataset.type === 'add') return '➕ Drop Add Details Here';
                if (zone.dataset.type === 'number') return '🔢 Drop Number Order Here';
                
                // WRITE placeholders
                if (zone.dataset.type === 'write') return '✍️ Drop Write Step Here';
                if (zone.dataset.type === 'revise') return '🔄 Drop Revise Step Here';
                if (zone.dataset.type === 'improve') return '⬆️ Drop Improve Step Here';
                if (zone.dataset.type === 'transform') return '🔄 Drop Transform Step Here';
                if (zone.dataset.type === 'edit') return '✏️ Drop Edit Step Here';
                
                // DARE placeholders
                if (zone.dataset.type === 'develop') return '🌱 Drop Develop Step Here';
                if (zone.dataset.type === 'reject') return '❌ Drop Reject Weak Ideas Here';
                if (zone.dataset.type === 'end') return '🏁 Drop End Strong Here';
                
                // ANSWER placeholders
                if (zone.dataset.type === 'analyze') return '🔍 Drop Analyze Step Here';
                if (zone.dataset.type === 'notice') return '👀 Drop Notice Step Here';
                if (zone.dataset.type === 'setup') return '🏗️ Drop Set Up Step Here';
                if (zone.dataset.type === 'workin') return '⚙️ Drop Work In Step Here';
                if (zone.dataset.type === 'engineer') return '🔧 Drop Engineer Step Here';
                if (zone.dataset.type === 'review') return '✅ Drop Review Step Here';
                
                return 'Drop items here';
            }

            getItemsForStation(station) {
                const roundIndex = this.currentRound[station];
                
                const stationContent = {
                    tree: [
                        // Round 1
                        [
                            {text: "Schools should require uniforms for all students", data: {type: "topic"}},
                            {text: "Uniforms promote equality among students", data: {type: "reason1"}},
                            {text: "They reduce morning decision stress", data: {type: "reason2"}},
                            {text: "Therefore, school uniforms benefit everyone", data: {type: "ending"}},
                            {text: "Some students prefer casual clothes", data: {type: "wrong"}},
                            {text: "Fashion is important for creativity", data: {type: "wrong"}},
                        ],
                        // Round 2
                        [
                            {text: "Video games can improve problem-solving skills", data: {type: "topic"}},
                            {text: "Games require strategic thinking and planning", data: {type: "reason1"}},
                            {text: "Players must adapt quickly to new challenges", data: {type: "reason2"}},
                            {text: "Gaming can be an educational tool", data: {type: "ending"}},
                            {text: "Video games are just entertainment", data: {type: "wrong"}},
                            {text: "Too much gaming causes problems", data: {type: "wrong"}},
                        ],
                        // Round 3
                        [
                            {text: "Recycling should be mandatory in all communities", data: {type: "topic"}},
                            {text: "It reduces waste in landfills significantly", data: {type: "reason1"}},
                            {text: "Recycling conserves natural resources", data: {type: "reason2"}},
                            {text: "Mandatory recycling protects our environment", data: {type: "ending"}},
                            {text: "Recycling programs cost too much money", data: {type: "wrong"}},
                            {text: "People should choose for themselves", data: {type: "wrong"}},
                        ]
                    ],
                    stop: [
                        // Round 1
                        [
                            {text: "Read the prompt carefully without rushing", data: {type: "suspend"}},
                            {text: "Decide to support school uniforms", data: {type: "take"}},
                            {text: "Group similar arguments together", data: {type: "organize"}},
                            {text: "Create an outline before writing", data: {type: "plan"}},
                            {text: "Start writing your first sentence", data: {type: "wrong"}},
                            {text: "Pick the easiest side to argue", data: {type: "wrong"}},
                        ],
                        // Round 2
                        [
                            {text: "Consider both sides of the debate", data: {type: "suspend"}},
                            {text: "Choose your position on social media", data: {type: "take"}},
                            {text: "Sort evidence by importance", data: {type: "organize"}},
                            {text: "Map out your essay structure", data: {type: "plan"}},
                            {text: "Write whatever comes to mind first", data: {type: "wrong"}},
                            {text: "Go with your gut feeling immediately", data: {type: "wrong"}},
                        ],
                        // Round 3
                        [
                            {text: "Think about all viewpoints first", data: {type: "suspend"}},
                            {text: "Take a stand on climate action", data: {type: "take"}},
                            {text: "Arrange ideas from strongest to weakest", data: {type: "organize"}},
                            {text: "Design your paragraph order", data: {type: "plan"}},
                            {text: "Jump straight into conclusions", data: {type: "wrong"}},
                            {text: "Avoid considering opposing views", data: {type: "wrong"}},
                        ]
                    ],
                    plan: [
                        // Round 1
                        [
                            {text: "What is the writing task asking me to do?", data: {type: "prompt"}},
                            {text: "Brainstorm: uniforms, equality, cost, freedom", data: {type: "list"}},
                            {text: "Include evidence about school studies", data: {type: "add"}},
                            {text: "1. Topic 2. Reason A 3. Reason B 4. Ending", data: {type: "number"}},
                            {text: "Start with the conclusion first", data: {type: "wrong"}},
                            {text: "Write without any planning", data: {type: "wrong"}},
                        ],
                        // Round 2
                        [
                            {text: "Analyze what the prompt requires", data: {type: "prompt"}},
                            {text: "List: benefits, risks, studies, examples", data: {type: "list"}},
                            {text: "Add statistics about screen time", data: {type: "add"}},
                            {text: "Order: intro, pro, con, conclusion", data: {type: "number"}},
                            {text: "Skip the planning phase entirely", data: {type: "wrong"}},
                            {text: "Use only personal opinions", data: {type: "wrong"}},
                        ],
                        // Round 3
                        [
                            {text: "Understand the assignment requirements", data: {type: "prompt"}},
                            {text: "Generate: pollution, solutions, costs, benefits", data: {type: "list"}},
                            {text: "Include expert quotes and data", data: {type: "add"}},
                            {text: "Structure: problem, solution, evidence, call to action", data: {type: "number"}},
                            {text: "Write the first draft immediately", data: {type: "wrong"}},
                            {text: "Focus only on one perspective", data: {type: "wrong"}},
                        ]
                    ],
                    write: [
                        // Round 1
                        [
                            {text: "Get your ideas down on paper first", data: {type: "write"}},
                            {text: "Read through and fix unclear parts", data: {type: "revise"}},
                            {text: "Add stronger vocabulary and details", data: {type: "improve"}},
                            {text: "Change weak sentences to powerful ones", data: {type: "transform"}},
                            {text: "Check spelling, grammar, and punctuation", data: {type: "edit"}},
                            {text: "Submit your first draft immediately", data: {type: "wrong"}},
                        ],
                        // Round 2
                        [
                            {text: "Draft your complete essay quickly", data: {type: "write"}},
                            {text: "Reread and clarify confusing sections", data: {type: "revise"}},
                            {text: "Strengthen arguments with better evidence", data: {type: "improve"}},
                            {text: "Turn simple sentences into complex ones", data: {type: "transform"}},
                            {text: "Proofread for all types of errors", data: {type: "edit"}},
                            {text: "Perfect each sentence as you write", data: {type: "wrong"}},
                        ],
                        // Round 3
                        [
                            {text: "Write your thoughts without stopping", data: {type: "write"}},
                            {text: "Review and reorganize paragraphs", data: {type: "revise"}},
                            {text: "Enhance with specific examples", data: {type: "improve"}},
                            {text: "Convert passive voice to active voice", data: {type: "transform"}},
                            {text: "Final check for mechanics and flow", data: {type: "edit"}},
                            {text: "Edit while writing each paragraph", data: {type: "wrong"}},
                        ]
                    ],
                    dare: [
                        // Round 1
                        [
                            {text: "Expand your topic sentence with details", data: {type: "develop"}},
                            {text: "Include statistics and expert opinions", data: {type: "add"}},
                            {text: "Remove weak or irrelevant points", data: {type: "reject"}},
                            {text: "Conclude with a strong final statement", data: {type: "end"}},
                            {text: "Keep all your original ideas", data: {type: "wrong"}},
                            {text: "End abruptly without conclusion", data: {type: "wrong"}},
                        ],
                        // Round 2
                        [
                            {text: "Build stronger supporting paragraphs", data: {type: "develop"}},
                            {text: "Insert compelling evidence and examples", data: {type: "add"}},
                            {text: "Cut out repetitive or weak arguments", data: {type: "reject"}},
                            {text: "Finish with a memorable closing", data: {type: "end"}},
                            {text: "Accept every idea you brainstormed", data: {type: "wrong"}},
                            {text: "Stop writing when you run out of ideas", data: {type: "wrong"}},
                        ],
                        // Round 3
                        [
                            {text: "Strengthen each main argument fully", data: {type: "develop"}},
                            {text: "Add research and real-world connections", data: {type: "add"}},
                            {text: "Eliminate contradictory statements", data: {type: "reject"}},
                            {text: "Create a powerful call to action", data: {type: "end"}},
                            {text: "Include every detail you can think of", data: {type: "wrong"}},
                            {text: "Trail off without a real ending", data: {type: "wrong"}},
                        ]
                    ],
                    answer: [
                        // Round 1
                        [
                            {text: "Break down the question into parts", data: {type: "analyze"}},
                            {text: "Spot the key requirements and limits", data: {type: "notice"}},
                            {text: "Organize your response structure", data: {type: "setup"}},
                            {text: "Develop ideas within word/time limits", data: {type: "workin"}},
                            {text: "Create a complete, focused response", data: {type: "engineer"}},
                            {text: "Check that you answered everything", data: {type: "review"}},
                        ],
                        // Round 2
                        [
                            {text: "Examine what the prompt is asking", data: {type: "analyze"}},
                            {text: "Identify action words like 'compare' or 'explain'", data: {type: "notice"}},
                            {text: "Plan your approach to the task", data: {type: "setup"}},
                            {text: "Stay focused on the specific requirements", data: {type: "workin"}},
                            {text: "Build a response that fully addresses the prompt", data: {type: "engineer"}},
                            {text: "Verify you've covered all parts", data: {type: "review"}},
                        ],
                        // Round 3
                        [
                            {text: "Study the prompt for hidden requirements", data: {type: "analyze"}},
                            {text: "Find directive words that guide your response", data: {type: "notice"}},
                            {text: "Establish your framework for answering", data: {type: "setup"}},
                            {text: "Keep your content relevant and on-topic", data: {type: "workin"}},
                            {text: "Construct a thorough, well-organized answer", data: {type: "engineer"}},
                            {text: "Double-check against the original question", data: {type: "review"}},
                        ]
                    ]
                };

                const stationRounds = stationContent[station];
                if (!stationRounds) return [];
                
                const currentRoundIndex = roundIndex % stationRounds.length;
                return stationRounds[currentRoundIndex] || stationRounds[0];
            }

            setupDragAndDrop() {
                const dragItems = document.querySelectorAll('.drag-item');
                const dropZones = document.querySelectorAll('.drop-zone');

                dragItems.forEach(item => {
                    item.addEventListener('dragstart', (e) => {
                        if (item.classList.contains('used')) {
                            e.preventDefault();
                            return;
                        }
                        
                        const data = {
                            text: item.textContent,
                            element: item.outerHTML
                        };
                        
                        Object.keys(item.dataset).forEach(key => {
                            data[key] = item.dataset[key];
                        });
                        
                        e.dataTransfer.setData('text/plain', JSON.stringify(data));
                        item.style.opacity = '0.5';
                    });

                    item.addEventListener('dragend', (e) => {
                        item.style.opacity = '1';
                    });
                });

                dropZones.forEach(zone => {
                    zone.addEventListener('dragover', (e) => {
                        e.preventDefault();
                        zone.classList.add('drag-over');
                    });

                    zone.addEventListener('dragleave', () => {
                        zone.classList.remove('drag-over');
                    });

                    zone.addEventListener('drop', (e) => {
                        e.preventDefault();
                        zone.classList.remove('drag-over');
                        
                        const data = JSON.parse(e.dataTransfer.getData('text/plain'));
                        this.handleDrop(zone, data);
                    });
                });
            }

            createSparkles(element) {
                const rect = element.getBoundingClientRect();
                for (let i = 0; i < 8; i++) {
                    const sparkle = document.createElement('div');
                    sparkle.style.position = 'absolute';
                    sparkle.style.left = `${rect.left + Math.random() * rect.width}px`;
                    sparkle.style.top = `${rect.top + Math.random() * rect.height}px`;
                    sparkle.style.width = '6px';
                    sparkle.style.height = '6px';
                    sparkle.style.background = '#ffd700';
                    sparkle.style.borderRadius = '50%';
                    sparkle.style.pointerEvents = 'none';
                    sparkle.style.zIndex = '1000';
                    sparkle.style.animation = 'sparkle 1.5s ease-out forwards';
                    
                    document.body.appendChild(sparkle);
                    
                    setTimeout(() => {
                        sparkle.remove();
                    }, 1500);
                }
            }

            createCelebration() {
                const celebration = document.getElementById('celebration');
                for (let i = 0; i < 30; i++) {
                    const confetti = document.createElement('div');
                    confetti.className = 'confetti';
                    confetti.style.left = `${Math.random() * 100}%`;
                    confetti.style.background = `hsl(${Math.random() * 360}, 70%, 60%)`;
                    confetti.style.animationDelay = `${Math.random() * 2}s`;
                    celebration.appendChild(confetti);
                    
                    setTimeout(() => {
                        confetti.remove();
                    }, 3000);
                }
            }

            playSuccessSound() {
                if (typeof AudioContext !== 'undefined' || typeof webkitAudioContext !== 'undefined') {
                    const audioContext = new (AudioContext || webkitAudioContext)();
                    const oscillator = audioContext.createOscillator();
                    const gainNode = audioContext.createGain();
                    
                    oscillator.connect(gainNode);
                    gainNode.connect(audioContext.destination);
                    
                    oscillator.frequency.setValueAtTime(800, audioContext.currentTime);
                    oscillator.frequency.exponentialRampToValueAtTime(1200, audioContext.currentTime + 0.1);
                    
                    gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.3);
                    
                    oscillator.start(audioContext.currentTime);
                    oscillator.stop(audioContext.currentTime + 0.3);
                }
            }

            initTTS() {
                if ('speechSynthesis' in window) {
                    this.speechSynthesis = window.speechSynthesis;
                }
            }

            speakText(text) {
                if (!this.speechSynthesis) return;
                
                this.speechSynthesis.cancel();
                const utterance = new SpeechSynthesisUtterance(text);
                utterance.rate = 0.9;
                utterance.pitch = 1.0;
                utterance.volume = 0.8;
                this.speechSynthesis.speak(utterance);
            }
        }

        // Add sparkle animation CSS
        const style = document.createElement('style');
        style.textContent = `
            @keyframes sparkle {
                0% {
                    transform: scale(0) rotate(0deg);
                    opacity: 1;
                }
                50% {
                    transform: scale(1.5) rotate(180deg);
                    opacity: 1;
                }
                100% {
                    transform: scale(0) rotate(360deg);
                    opacity: 0;
                }
            }
        `;
        document.head.appendChild(style);

        // Initialize the enhanced game
        const game = new WritingArcade();
        window.game = game;
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'988a939d32137ad9',t:'MTc1OTQ3NDk3NC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
